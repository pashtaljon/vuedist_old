(function(e){function t(t){for(var n,a,r=t[0],o=t[1],l=t[2],d=0,v=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&v.push(i[a][0]),i[a]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);u&&u(t);while(v.length)v.shift()();return s.push.apply(s,l||[]),c()}function c(){for(var e,t=0;t<s.length;t++){for(var c=s[t],n=!0,r=1;r<c.length;r++){var o=c[r];0!==i[o]&&(n=!1)}n&&(s.splice(t--,1),e=a(a.s=c[0]))}return e}var n={},i={app:0},s=[];function a(t){if(n[t])return n[t].exports;var c=n[t]={i:t,l:!1,exports:{}};return e[t].call(c.exports,c,c.exports,a),c.l=!0,c.exports}a.m=e,a.c=n,a.d=function(e,t,c){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:c})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(c,n,function(t){return e[t]}.bind(null,n));return c},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=o;s.push([0,"chunk-vendors"]),c()})({0:function(e,t,c){e.exports=c("cd49")},"04ac":function(e,t,c){"use strict";c("1077")},"05f9":function(e,t,c){e.exports=c.p+"img/icon-done.8a4d0806.svg"},1077:function(e,t,c){},"141a":function(e,t,c){e.exports=c.p+"img/icon-flash.062da934.svg"},1780:function(e,t,c){e.exports=c.p+"img/app_general.f9d3f6a7.png"},"1ae4":function(e,t,c){e.exports=c.p+"img/logo.c8f7a560.svg"},"23b6":function(e,t,c){"use strict";c("d66f")},"2de5":function(e,t,c){e.exports=c.p+"img/app_slide_stats.ca7e5757.png"},3394:function(e,t,c){},"39c0":function(e,t,c){e.exports=c.p+"img/sync-black.911d7996.svg"},"39df":function(e,t,c){e.exports=c.p+"img/icon-stats.33457b82.svg"},4374:function(e,t,c){"use strict";c("3394")},"49b9":function(e,t,c){e.exports=c.p+"img/icon-add-device.429e9335.svg"},"4eca":function(e,t,c){e.exports=c.p+"img/app_slide_slow.c78d0ec9.png"},5123:function(e,t,c){"use strict";c("6f1d")},6749:function(e,t,c){var n,i,s;(function(a,r){i=[c("c4e3")],n=r,s="function"===typeof n?n.apply(t,i):n,void 0===s||(e.exports=s)})(0,(function(e){"use strict";function t(e){this.buffer=e,this.zipFile=null,this.manifest=null}return t.prototype.load=function(){return e.loadAsync(this.buffer).then(e=>{this.zipFile=e;try{return this.zipFile.file("manifest.json").async("string")}catch(t){throw new Error("Unable to find manifest, is this a proper DFU package?")}}).then(e=>(this.manifest=JSON.parse(e).manifest,this))},t.prototype.getImage=function(e){for(var t of e)if(this.manifest[t]){var c=this.manifest[t],n={type:t,initFile:c.dat_file,imageFile:c.bin_file};return this.zipFile.file(n.initFile).async("arraybuffer").then(e=>(n.initData=e,this.zipFile.file(n.imageFile).async("arraybuffer"))).then(e=>(n.imageData=e,n))}},t.prototype.getBaseImage=function(){return this.getImage(["softdevice","bootloader","softdevice_bootloader"])},t.prototype.getAppImage=function(){return this.getImage(["application"])},t}))},"6f1d":function(e,t,c){},8410:function(e,t,c){e.exports=c.p+"img/battery.a97f5aa7.svg"},abe1:function(e,t,c){e.exports=c.p+"img/icon-error.d211846a.svg"},b08a:function(e,t,c){e.exports=c.p+"img/icon-settings.1fafe628.svg"},c611:function(e,t,c){e.exports=c.p+"img/icon-arrow-down.65765fac.svg"},ca9f:function(e,t,c){e.exports=c.p+"img/bluetooth.9d93a16a.svg"},cd49:function(e,t,c){"use strict";c.r(t);var n=c("7a23"),i=c("c611"),s=c.n(i),a=c("ca9f"),r=c.n(a),o=c("8410"),l=c.n(o),u=c("ee16"),d=c.n(u),v=c("fd19"),b=c.n(v),h=c("39df"),f=c.n(h),j=c("b08a"),p=c.n(j),O=c("141a"),g=c.n(O),m={class:"wrapper"},y={class:"over-18"},w=Object(n["h"])("div",{class:"title"},[Object(n["j"])("Вам уже"),Object(n["h"])("br"),Object(n["j"])("есть 18 лет?")],-1),D=Object(n["h"])("div",{class:"description"},[Object(n["j"])("Я подтверждаю, что мне"),Object(n["h"])("br"),Object(n["j"])("исполнилось 18 лет")],-1),C={class:"btn-group"},S=Object(n["h"])("div",{class:"bg-filter"},null,-1),k={key:0,class:"alert-update"},L={class:"content"},N=Object(n["h"])("div",{class:"title"},[Object(n["j"])("Доступно"),Object(n["h"])("br"),Object(n["j"])("обновление")],-1),x={class:"total-version"},H=Object(n["h"])("span",null,"Текущая версия",-1),I={class:"version"},U=Object(n["h"])("div",{class:"icon-arrow"},[Object(n["h"])("img",{src:s.a})],-1),T={class:"new-version"},P={class:"version"},E=Object(n["h"])("span",null,"Новая версия",-1),F=Object(n["h"])("div",{class:"bg-filter"},null,-1),V={class:"icon"},A={key:0,src:r.a},M={key:1,src:l.a},q={key:2,src:d.a},_={class:"text"},W={key:0,class:"main-menu"},z=Object(n["h"])("img",{src:b.a},null,-1),B=Object(n["h"])("img",{src:f.a},null,-1),R=Object(n["h"])("img",{src:p.a},null,-1),$=Object(n["h"])("img",{src:g.a},null,-1);function G(e,t,c,i,s,a){var r=Object(n["B"])("router-view"),o=Object(n["B"])("router-link");return Object(n["w"])(),Object(n["g"])("div",null,[Object(n["h"])("div",m,[Object(n["k"])(r,null,{default:Object(n["H"])((function(t){var c=t.Component;return[Object(n["k"])(n["b"],{name:"slide-fade",mode:"out-in"},{default:Object(n["H"])((function(){return[(Object(n["w"])(),Object(n["e"])(Object(n["C"])(c),{key:e.$router.path}))]})),_:2},1024)]})),_:1})]),Object(n["h"])("div",{class:Object(n["q"])(["slideup",1==e.slideupConfirmAge?"activate":"deactivate"])},[Object(n["h"])("div",y,[w,D,Object(n["h"])("div",C,[Object(n["h"])("a",{href:"#",class:"btn active",onClick:t[0]||(t[0]=function(t){return e.slideupConfirmAgeStatus(!0,t)})},"Да"),Object(n["h"])("a",{href:"#",class:"btn",onClick:t[1]||(t[1]=function(t){return e.slideupConfirmAgeStatus(!1,t)})},"Нет")])]),S],2),Object(n["k"])(n["b"],{name:"slide-fadeup",mode:"out-in"},{default:Object(n["H"])((function(){return[e.alertUpdateStatus?(Object(n["w"])(),Object(n["g"])("div",k,[Object(n["h"])("div",L,[N,Object(n["h"])("div",x,[H,Object(n["h"])("div",I,Object(n["E"])(e.fwCurrentVersion),1)]),U,Object(n["h"])("div",T,[Object(n["h"])("div",P,Object(n["E"])(e.fwServerVersion),1),E]),Object(n["h"])("div",{class:"btn-update",onClick:t[2]||(t[2]=function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];return e.alertUpdateGo&&e.alertUpdateGo.apply(e,t)})},"Обновить"),Object(n["h"])("div",{class:"btn-cancel",onClick:t[3]||(t[3]=function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];return e.alertUpdateCancel&&e.alertUpdateCancel.apply(e,t)})},"Обновить позже")]),F])):Object(n["f"])("",!0)]})),_:1}),Object(n["h"])("div",{class:Object(n["q"])(["tooltip-notify",e.notifyTooltip.status?"activate":""])},[Object(n["h"])("div",V,["device"==e.notifyTooltip.icon?(Object(n["w"])(),Object(n["g"])("img",A)):Object(n["f"])("",!0),"charge"==e.notifyTooltip.icon?(Object(n["w"])(),Object(n["g"])("img",M)):Object(n["f"])("",!0),"tasty"==e.notifyTooltip.icon?(Object(n["w"])(),Object(n["g"])("img",q)):Object(n["f"])("",!0)]),Object(n["h"])("div",_,Object(n["E"])(e.notifyTooltip.message),1)],2),Object(n["k"])(n["b"],{name:"slide-fade",mode:"out-in"},{default:Object(n["H"])((function(){return["Main"==e.$router.currentRoute.value.name||"Stats"==e.$router.currentRoute.value.name||"Settings"==e.$router.currentRoute.value.name||"System"==e.$router.currentRoute.value.name?(Object(n["w"])(),Object(n["g"])("div",W,[Object(n["k"])(o,{to:"/"},{default:Object(n["H"])((function(){return[z]})),_:1}),Object(n["k"])(o,{to:"/stats"},{default:Object(n["H"])((function(){return[B]})),_:1}),Object(n["k"])(o,{to:"/settings"},{default:Object(n["H"])((function(){return[R]})),_:1}),Object(n["k"])(o,{to:"/system"},{default:Object(n["H"])((function(){return[$]})),_:1})])):Object(n["f"])("",!0)]})),_:1})])}var J=c("9ab4"),Q=c("5502"),Y=c("6c02"),K=Object(n["l"])({name:"App",setup:function(){var e=this,t=Object(Q["b"])(),c=Object(Y["c"])(),i=Object(n["c"])((function(){return t.state.alertUpdateStatus})),s=Object(n["c"])((function(){return t.state.slideupConfirmAge})),a=Object(n["c"])((function(){return t.state.connectDeviceInProcess})),r=Object(n["c"])((function(){return t.state.deviceConnect})),o=function(c){return Object(J["a"])(e,void 0,void 0,(function(){return Object(J["b"])(this,(function(e){switch(e.label){case 0:return[4,t.dispatch("connectPlonq")];case 1:return e.sent(),t.state.deviceConnect?(t.state.slideupConnectDevice=!1,l(c)):t.dispatch("startNotifyTooltip",{message:"Ошибка подключения",icon:"device"}),[2]}}))}))};function l(e){e.target.closest(".slideup").style.display="block",setTimeout((function(){e.target.closest(".slideup").style.display="none"}),600)}var u=function(e,n){1==e?(t.state.slideupConfirmAge=!1,l(n),setTimeout((function(){c.push({name:"Sync"})}),600)):window.location.href="http://localhost:8080"},d=Object(n["c"])((function(){return t.state.notifyTooltip})),v=function(){t.commit("setAlertUpdateStatus",!1)},b=function(){c.push({name:"FirmwareUpdate"}),t.commit("setAlertUpdateStatus",!1)},h=Object(n["c"])((function(){return t.state.deviceDetail.firmware})),f=Object(n["c"])((function(){return t.state.firmwareData.version})),j=Object(n["c"])((function(){return t.state.slideupConnectDevice})),p=Object(n["c"])((function(){return t.state.statusUpdateNow}));return Object(n["u"])((function(){0==t.state.onboard&&c.push({name:"Onboard"}),t.state.deviceDetail.firmware.length<1&&1==t.state.onboard&&(t.state.slideupConnectDevice=!0)})),{notifyTooltip:d,slideupConfirmAge:s,slideupConfirmAgeStatus:u,slideupClose:l,alertUpdateStatus:i,alertUpdateGo:b,alertUpdateCancel:v,fwCurrentVersion:h,fwServerVersion:f,slideupConnectDevice:j,connectPlonq:o,connectDeviceInProcess:a,deviceConnect:r,statusUpdateNow:p}}}),X=(c("4374"),c("6b0d")),Z=c.n(X);const ee=Z()(K,[["render",G]]);var te=ee,ce=c("1ae4"),ne=c.n(ce),ie={class:"main-page"},se={class:"header"},ae={class:"info"},re=Object(n["h"])("div",{class:"logo"},[Object(n["h"])("img",{src:ne.a})],-1),oe={class:"stats"},le={class:"item"},ue=Object(n["h"])("div",{class:"icon"},[Object(n["h"])("img",{src:r.a})],-1),de={class:"text"},ve={class:"item"},be=Object(n["h"])("div",{class:"icon"},[Object(n["h"])("img",{src:l.a})],-1),he={class:"text"},fe={class:"item"},je=Object(n["h"])("div",{class:"icon"},[Object(n["h"])("img",{src:d.a})],-1),pe={class:"text"},Oe={class:"device"},ge=Object(n["h"])("div",{class:"device-bg"},null,-1),me={class:"main-content"},ye=Object(n["h"])("div",{class:"today"},[Object(n["j"])("Сегодня "),Object(n["h"])("span",{class:"bold"},"30 июня")],-1),we={class:"counter-group"},De={class:"item-counter active"},Ce={class:"count count-today"},Se=Object(n["h"])("div",{class:"label"},"Затяжек",-1),ke=Object(n["h"])("div",{class:"item-counter"},[Object(n["h"])("div",{class:"count count-week"},"128"),Object(n["h"])("div",{class:"label"},[Object(n["j"])("Среднее за тоже время"),Object(n["h"])("br"),Object(n["j"])("(последние 7 дней)")])],-1);function Le(e,t,i,s,a,r){return Object(n["w"])(),Object(n["g"])("div",ie,[Object(n["h"])("div",se,[Object(n["h"])("div",ae,[re,Object(n["h"])("div",oe,[Object(n["h"])("div",le,[ue,Object(n["h"])("div",de,Object(n["E"])(e.deviceConnect?"Подключено":"Отключено"),1)]),Object(n["h"])("div",ve,[be,Object(n["h"])("div",he,Object(n["E"])(e.deviceConnect?e.deviceDetail.batteryLevel:"0")+"%",1)]),Object(n["h"])("div",fe,[je,Object(n["h"])("div",pe,Object(n["E"])(e.getCartridge),1)])])]),Object(n["h"])("div",Oe,[Object(n["h"])("div",{class:"device-image",style:Object(n["r"])("background-image: url('"+c("f92f")+"')")},null,4),ge])]),Object(n["h"])("div",me,[ye,Object(n["h"])("div",we,[Object(n["h"])("div",De,[Object(n["h"])("div",Ce,Object(n["E"])(e.puffCounter),1),Se]),ke])])])}var Ne=Object(n["l"])({name:"Main",setup:function(){var e=Object(Q["b"])(),t=Object(n["c"])((function(){return e.state.deviceConnect})),c=Object(n["c"])((function(){return e.state.deviceDetail})),i=Object(n["c"])((function(){var e=c.value.cartridge,t=null;switch(e){case 0:t="Нет картриджа";break;case 255:t="Технический";break;default:t="Новый вкус";break}return t})),s=Object(n["c"])((function(){return e.state.deviceDetail.puffCounter}));return{deviceConnect:t,deviceDetail:c,getCartridge:i,puffCounter:s}}});c("e24e");const xe=Z()(Ne,[["render",Le]]);var He=xe,Ie=c("39c0"),Ue=c.n(Ie),Te=c("49b9"),Pe=c.n(Te),Ee={class:"settings-page"},Fe=Object(n["h"])("div",{class:"logo"},[Object(n["h"])("img",{src:ne.a})],-1),Ve={class:"device-detail"},Ae={class:"item-detail"},Me={class:"item-detail"},qe=Object(n["h"])("div",{class:"device-control"},[Object(n["h"])("div",{class:"item-control"},[Object(n["h"])("div",{class:"circle"},[Object(n["h"])("img",{src:Ue.a})]),Object(n["h"])("div",{class:"description"},[Object(n["j"])("проверить обновление"),Object(n["h"])("br"),Object(n["j"])("прошивки "),Object(n["h"])("span",{class:"bold"},"plonq")])]),Object(n["h"])("div",{class:"item-control"},[Object(n["h"])("div",{class:"circle"},[Object(n["h"])("img",{src:Pe.a})]),Object(n["h"])("div",{class:"description"},[Object(n["j"])("подключить другой"),Object(n["h"])("br"),Object(n["h"])("span",{class:"bold"},"plonq")])])],-1);function _e(e,t,c,i,s,a){return Object(n["w"])(),Object(n["g"])("div",null,[Object(n["h"])("div",Ee,[Fe,Object(n["h"])("div",Ve,[Object(n["h"])("div",Ae,"Устройство "+Object(n["E"])((e.deviceDetail.deviceName+" "+e.deviceDetail.deviceModel).toUpperCase()),1),Object(n["h"])("div",Me,"Версия прошивки "+Object(n["E"])(e.deviceDetail.firmware),1)]),qe])])}var We=Object(n["l"])({name:"Settings",setup:function(){var e=Object(Q["b"])(),t=Object(n["c"])((function(){return e.state.deviceDetail}));return{deviceDetail:t}}});c("23b6");const ze=Z()(We,[["render",_e]]);var Be=ze,Re={class:"settings-page"},$e=Object(n["h"])("div",{class:"section-title"},"Раздел тестирования",-1),Ge={class:"params"},Je={class:"item-param"},Qe={class:"item-param"},Ye={class:"item-param"},Ke={class:"item-param"},Xe={class:"item-param"},Ze={class:"item-param"},et={class:"item-param"},tt={class:"terminal"};function ct(e,t,c,i,s,a){return Object(n["w"])(),Object(n["g"])("div",null,[Object(n["h"])("div",Re,[$e,Object(n["h"])("div",Ge,[Object(n["h"])("div",Je,"Статус устройства: "+Object(n["E"])(e.plonq.deviceConnect?"Подключено":"Не подключено"),1),Object(n["h"])("div",Qe,"Версия прошивки: "+Object(n["E"])(e.deviceFirmware),1),Object(n["h"])("div",Ye,"MAC адрес: "+Object(n["E"])(e.deviceMac),1),Object(n["h"])("div",Ke,"Статус зарядки: "+Object(n["E"])(e.deviceCharge?"Заряжается":"Не заряжается"),1),Object(n["h"])("div",Xe,"Кол-во затяжек: "+Object(n["E"])(e.devicePuff),1),Object(n["h"])("div",Ze,"Батарея: "+Object(n["E"])(e.deviceBattery)+"%",1),Object(n["h"])("div",et,"Картридж: "+Object(n["E"])(e.deviceCartridge),1)]),Object(n["h"])("div",{class:"btn-click",onClick:t[0]||(t[0]=function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];return e.startDeviceConnect&&e.startDeviceConnect.apply(e,t)})},"Подключиться к устройству"),Object(n["h"])("div",{class:"btn-click",onClick:t[1]||(t[1]=function(t){return e.setCommand(85)})},"Запуск режима DFU (0x55)"),Object(n["h"])("div",{class:"btn-click",onClick:t[2]||(t[2]=function(t){return e.setCommand(208)})},"Затяжки каждые 30 сек (0xD0)"),Object(n["h"])("div",tt,[(Object(n["w"])(!0),Object(n["g"])(n["a"],null,Object(n["A"])(e.terminalList,(function(e,t){return Object(n["w"])(),Object(n["g"])("div",{class:"item",key:t},Object(n["E"])(e),1)})),128))])])])}var nt=Object(n["l"])({name:"System",setup:function(){var e=this,t=Object(Q["b"])(),c=Object(n["c"])((function(){return t.state.deviceConnect})),i=Object(n["c"])((function(){return t.state.deviceDetail.firmware})),s=Object(n["c"])((function(){return t.state.deviceDetail.mac})),a=Object(n["c"])((function(){return t.state.deviceDetail.puffCounter})),r=Object(n["c"])((function(){return t.state.deviceDetail.batteryLevel})),o=Object(n["c"])((function(){return t.state.deviceDetail.cartridge})),l=Object(n["c"])((function(){return t.state.deviceDetail.chargeStatus})),u=Object(n["c"])((function(){return t.state.plonq})),d=Object(n["c"])((function(){return t.state.terminal.reverse()})),v=function(){return Object(J["a"])(e,void 0,void 0,(function(){return Object(J["b"])(this,(function(e){switch(e.label){case 0:return[4,t.dispatch("connectPlonq")];case 1:return e.sent(),[2]}}))}))},b=function(e){switch(e){case 85:u.value.startCommand(e),t.state.terminal.push("Отправляем команду 0x55");break;case 208:u.value.startCommand(e),t.state.terminal.push("Отправляем команду 0xD0");break}};return{plonq:u,terminalList:d,setCommand:b,deviceConnect:c,startDeviceConnect:v,deviceFirmware:i,deviceMac:s,devicePuff:a,deviceBattery:r,deviceCartridge:o,deviceCharge:l}}});c("5123");const it=Z()(nt,[["render",ct]]);var st=it,at=c("05f9"),rt=c.n(at),ot=c("abe1"),lt=c.n(ot);const ut={class:"firmware-update-info-setup"},dt=Object(n["h"])("div",{class:"title"},[Object(n["j"])("Подготовка к"),Object(n["h"])("br"),Object(n["j"])("установке...")],-1),vt={class:"content"},bt=Object(n["h"])("div",{class:"label"},"Пожалуйста, убедитесь, что:",-1),ht={class:"setup-group"},ft={class:"item-setup"},jt=Object(n["h"])("div",{class:"description"},[Object(n["j"])("УСТРОЙСТВО И ТЕЛЕФОН Соединены ПО "),Object(n["h"])("span",{class:"bold"},"BLUETOOTH")],-1),pt={class:"item-setup"},Ot=Object(n["h"])("div",{class:"description"},[Object(n["j"])("УСТРОЙСТВО ПОСТАВЛЕНО НА "),Object(n["h"])("span",{class:"bold"},"ЗАРЯДКУ"),Object(n["j"])(" И ЗАРЯЖАЕТСЯ")],-1),gt={class:"btn-group"},mt=Object(n["h"])("span",null,"Продолжить",-1),yt=[mt],wt={key:0,class:"start-firmware-update"},Dt=Object(n["h"])("div",{class:"logo"},[Object(n["h"])("img",{src:ne.a})],-1),Ct=Object(n["h"])("div",{class:"description flashlight"},"Устанавливаем обновление",-1),St={class:"progress-bar"},kt={class:"percent"},Lt={key:0,class:"firmware-done"},Nt=Object(n["h"])("div",{class:"icon-device"},[Object(n["h"])("img",{src:rt.a})],-1),xt=Object(n["h"])("div",{class:"description"},"У вас установленна актуальная версия прошивки",-1),Ht={key:0,class:"firmware-error"},It=Object(n["h"])("div",{class:"icon-device"},[Object(n["h"])("img",{src:lt.a})],-1),Ut=Object(n["h"])("div",{class:"description"},"Ошибка при обновлении, повторите попытку позже",-1),Tt={class:"confirm"},Pt=Object(n["i"])('<div class="title">Последние проверки</div><div class="description"><span class="bold">Перед началом установки</span> - убедитесь что индикатор на устройстве загорелся <span class="bold">синим</span> цветом</div><div class="indicator"></div>',3),Et=Object(n["h"])("div",{class:"bg-filter"},null,-1);function Ft(e,t,c,i,s,a){return Object(n["w"])(),Object(n["g"])("div",null,[Object(n["h"])("div",ut,[dt,Object(n["h"])("div",vt,[bt,Object(n["h"])("div",ht,[Object(n["h"])("div",ft,[Object(n["h"])("div",{class:Object(n["q"])(["circle",e.deviceConnect?"active":""])},"1",2),jt]),Object(n["h"])("div",pt,[Object(n["h"])("div",{class:Object(n["q"])(["circle",e.chargeStatus?"active":""])},"2",2),Ot])])]),Object(n["h"])("div",gt,[Object(n["h"])("a",{href:"#",class:Object(n["q"])(["btn-sync",e.deviceConnect&&e.chargeStatus?"active":""]),onClick:t[0]||(t[0]=(...t)=>e.nextStepSetup&&e.nextStepSetup(...t))},yt,2),Object(n["h"])("a",{href:"#",class:"btn-cancel",onClick:t[1]||(t[1]=t=>e.router.push({name:"Main"}))},"Отменить")])]),Object(n["k"])(n["b"],{name:"slide-fade",mode:"out-in"},{default:Object(n["H"])(()=>[e.statusProcessUpdate?(Object(n["w"])(),Object(n["g"])("div",wt,[Dt,Ct,Object(n["h"])("div",St,[Object(n["h"])("div",{class:"progress",style:Object(n["r"])(`width: ${e.processUpdatePercent}%;`)},null,4)]),Object(n["h"])("div",kt,Object(n["E"])(e.processUpdatePercent)+"%",1)])):Object(n["f"])("",!0)]),_:1}),Object(n["k"])(n["b"],{name:"slide-fade",mode:"out-in"},{default:Object(n["H"])(()=>[e.statusProcessDone?(Object(n["w"])(),Object(n["g"])("div",Lt,[Nt,xt,Object(n["h"])("a",{href:"#",class:"btn-cancel",onClick:t[2]||(t[2]=(...t)=>e.statusProcessFinish&&e.statusProcessFinish(...t))},"Закрыть")])):Object(n["f"])("",!0)]),_:1}),Object(n["k"])(n["b"],{name:"slide-fade",mode:"out-in"},{default:Object(n["H"])(()=>[e.statusProcessError?(Object(n["w"])(),Object(n["g"])("div",Ht,[It,Ut,Object(n["h"])("a",{href:"#",class:"btn-cancel",onClick:t[3]||(t[3]=(...t)=>e.statusProcessErrorClose&&e.statusProcessErrorClose(...t))},"Закрыть")])):Object(n["f"])("",!0)]),_:1}),Object(n["h"])("div",{class:Object(n["q"])(["slideup",1==e.statusSlideupConfirm?"activate":"deactivate"])},[Object(n["h"])("div",Tt,[Pt,Object(n["h"])("div",{href:"#",class:Object(n["q"])(["btn-confirm",e.messageTimerToActive?"active":""]),onClick:t[4]||(t[4]=t=>{e.clickDFU(t)})},"Выбрать устройство",2)]),Et],2)])}var Vt=c("7837"),At=c.n(Vt),Mt=c("702d"),qt=c.n(Mt),_t=c("6749"),Wt=c.n(_t),zt=Object(n["l"])({name:"FirmwareUpdate",setup(){const e=Object(Q["b"])(),t=Object(Y["c"])(),c=Object(n["c"])(()=>e.state.deviceConnect),i=Object(n["c"])(()=>e.state.deviceDetail.chargeStatus),s=Object(n["z"])(!1),a=Object(n["z"])(!1),r=Object(n["z"])(!1),o=()=>{r.value=!1},l=Object(n["z"])(0),u=()=>{t.push({name:"Main"}),e.state.deviceConnect=!1},d=new At.a(qt.a.buf);d.SERVICE_UUID="FE59";const v=Object(n["c"])(()=>e.state.plonq),b=e=>{e.target.closest(".slideup").style.display="block",setTimeout(()=>{e.target.closest(".slideup").style.display="none"},600)},h=Object(n["z"])(!1),f=async()=>{c.value?(await v.value.startCommand(85),h.value=!0):alert("Выполните все шаги до начала установки")},j=()=>{};async function p(e){let t=await fetch(e),c=await t.blob(),n={type:"application/zip"},i=new File([c],"firmware.zip",n);return i}const O=e=>{if(!e)return void console.log("setTransfer empty");e.currentBytes,e.totalBytes,e.object;let t=parseInt(e.currentBytes/e.totalBytes*100);return l.value=t,t},g=async()=>{let t=await p(e.state.firmwareData.file);if(!t)return void console.log("Нет файла для установки");let c=new Wt.a(t);return await c.load(),c},m=async(t,c,n)=>{n?Promise.resolve().then(()=>(console.log("getBaseImage"),n.getBaseImage())).then(e=>{if(e)return console.log(`Updating ${e.type}: ${e.imageFile}...`),t.update(c,e.initData,e.imageData)}).then(()=>n.getAppImage()).then(e=>{if(e)return console.log(`Updating ${e.type}: ${e.imageFile}...`),t.update(c,e.initData,e.imageData)}).then(async()=>{console.log("Update complete!"),a.value=!0,e.state.statusUpdateNow=!1,O(0),setTimeout(async()=>{try{let t=await v.value.connect();if(t["connected"]){e.commit("setDeviceConnect",!0),e.commit("setDeviceDetail",await v.deviceDetail),await e.dispatch("startGattNotify",v);let t=`${e.state.deviceDetail.deviceName} ${e.state.deviceDetail.deviceModel}`.toUpperCase();context.dispatch("startNotifyTooltip",{message:t+" подключён",icon:"device"}),clearInterval(connectInterval)}else e.commit("setDeviceConnect",!0),e.commit("setSlideupConnectDevice",!0)}catch(t){console.log("Ошибка подключения к устройству TRY"),console.log(t)}},1500)}).catch(t=>{s.value=!1,a.value=!1,r.value=!0,console.log("Ошибка обновления прошивки"),console.log(t),e.state.statusUpdateNow=!1}):console.log("Pack не существует..")};d.addEventListener("log",e=>{}),d.addEventListener("progress",e=>{O(e)});const y=async e=>{let t=await d.requestDevice(!1,[{name:"DfuTarg"},{namePrefix:"DfuTarg"}]);t?(b(e),setTimeout(()=>{s.value=!0},600)):setTimeout(()=>{b(e)},600),console.log("Device.."),console.log(t),console.log("set Dfu Mode..."),console.log("Set package...");let c=await g();console.log("Start update..."),m(d,t,c)};return{deviceConnect:c,chargeStatus:i,clickDFU:y,statusProcessUpdate:s,processUpdatePercent:l,statusProcessDone:a,statusProcessError:r,statusProcessFinish:u,statusProcessErrorClose:o,messageTimerToActive:j,nextStepSetup:f,statusSlideupConfirm:h}}});c("04ac");const Bt=Z()(zt,[["render",Ft]]);var Rt=Bt,$t={class:"main-page"},Gt={class:"header"},Jt=Object(n["h"])("div",{class:"info"},[Object(n["h"])("div",{class:"logo"},[Object(n["h"])("img",{src:ne.a})]),Object(n["h"])("div",{class:"stats"},[Object(n["h"])("div",{class:"item"},[Object(n["h"])("div",{class:"icon"},[Object(n["h"])("img",{src:r.a})]),Object(n["h"])("div",{class:"text"},"подключено")]),Object(n["h"])("div",{class:"item"},[Object(n["h"])("div",{class:"icon"},[Object(n["h"])("img",{src:l.a})]),Object(n["h"])("div",{class:"text"},"72%")]),Object(n["h"])("div",{class:"item"},[Object(n["h"])("div",{class:"icon"},[Object(n["h"])("img",{src:d.a})]),Object(n["h"])("div",{class:"text"},"манго")])])],-1),Qt={class:"device"},Yt=Object(n["h"])("div",{class:"device-bg"},null,-1),Kt=Object(n["i"])('<div class="main-content"><div class="today">Сегодня <span class="bold">23 июня</span></div><div class="counter-group"><div class="item-counter active"><div class="count count-today">0</div><div class="label">Затяжек</div></div><div class="item-counter"><div class="count count-week">128</div><div class="label">Среднее за тоже время<br>(последние 7 дней)</div></div></div></div>',1);function Xt(e,t,i,s,a,r){return Object(n["w"])(),Object(n["g"])("div",$t,[Object(n["h"])("div",Gt,[Jt,Object(n["h"])("div",Qt,[Object(n["h"])("div",{class:"device-image",style:Object(n["r"])("background-image: url('"+c("f92f")+"')")},null,4),Yt])]),Kt])}var Zt=Object(n["l"])({name:"Stats"});const ec=Z()(Zt,[["render",Xt]]);var tc=ec,cc=c("1780"),nc=c.n(cc),ic=c("2de5"),sc=c.n(ic),ac=c("4eca"),rc=c.n(ac),oc={class:"onboarding-slide"},lc=Object(n["h"])("div",{class:"logo"},[Object(n["h"])("img",{src:ne.a})],-1),uc=Object(n["h"])("div",{class:"title"},[Object(n["j"])("123Управляйте курением"),Object(n["h"])("br"),Object(n["j"])("вместе c "),Object(n["h"])("span",{class:"bold"},"PLONQ")],-1),dc=Object(n["h"])("div",{class:"app-image"},[Object(n["h"])("img",{src:nc.a})],-1),vc=Object(n["h"])("div",{class:"title"},[Object(n["j"])("Следите за"),Object(n["h"])("br"),Object(n["j"])("статистикой курения")],-1),bc=Object(n["h"])("div",{class:"app-image"},[Object(n["h"])("img",{src:sc.a})],-1),hc=Object(n["h"])("div",{class:"title"},[Object(n["j"])("123Плавно снижайте"),Object(n["h"])("br"),Object(n["j"])("интенсивность")],-1),fc=Object(n["h"])("div",{class:"app-image"},[Object(n["h"])("img",{src:rc.a})],-1);function jc(e,t,c,i,s,a){return Object(n["w"])(),Object(n["g"])("div",null,[Object(n["h"])("div",oc,[lc,Object(n["h"])("div",{class:"onboarding-page",style:Object(n["r"])("left: "+e.slideLeftNumber[0]+"px")},[uc,dc,Object(n["h"])("a",{href:"javascript://",class:"next-slide",onClick:t[0]||(t[0]=function(t){return e.nextSlide(2)})},"Далее")],4),Object(n["h"])("div",{class:"onboarding-page",style:Object(n["r"])("left: "+e.slideLeftNumber[1]+"px")},[vc,bc,Object(n["h"])("a",{hef:"javascript://",class:"next-slide",onClick:t[1]||(t[1]=function(t){return e.nextSlide(3)})},"Далее")],4),Object(n["h"])("div",{class:"onboarding-page",style:Object(n["r"])("left: "+e.slideLeftNumber[2]+"px")},[hc,fc,Object(n["h"])("a",{hef:"javascript://",class:"next-slide",onClick:t[2]||(t[2]=function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];return e.confirmAge&&e.confirmAge.apply(e,t)})},"всё ясно")],4)])])}var pc=Object(n["l"])({name:"onboard",setup:function(){var e=this,t=Object(Q["b"])(),c=Object(n["z"])([0,window.innerWidth,2*window.innerWidth]),i=function(){t.state.slideupConfirmAge=!0,t.state.onboard=!0},s=function(t){return Object(J["a"])(e,void 0,void 0,(function(){return Object(J["b"])(this,(function(e){switch(t){case 1:c.value=[0,window.innerWidth,2*window.innerWidth];break;case 2:c.value=[window.innerWidth-2*window.innerWidth,0,window.innerWidth];break;case 3:c.value=[window.innerWidth-2*window.innerWidth*2,window.innerWidth-2*window.innerWidth,0];break;default:}return[2]}))}))};return{slideLeftNumber:c,nextSlide:s,confirmAge:i}}});const Oc=Z()(pc,[["render",jc]]);var gc=Oc,mc={class:"sync-page"},yc=Object(n["h"])("div",{class:"sync-preview"},[Object(n["h"])("div",{class:"preview-bg"})],-1),wc={class:"content"},Dc={key:0,class:"sync-description"},Cc=Object(n["j"])(" Поднесите "),Sc=Object(n["h"])("span",{class:"bold"},"PLONQ",-1),kc=Object(n["j"])(" к телефону и нажмите "),Lc=Object(n["h"])("span",{class:"bold"},"Подключить",-1),Nc=[Cc,Sc,kc,Lc],xc={key:1,class:"sync-description"},Hc=Object(n["j"])(" Пожалуйста, "),Ic=Object(n["h"])("span",{class:"bold"},"достаньте",-1),Uc=Object(n["j"])(" и "),Tc=Object(n["h"])("span",{class:"bold"},"вставьте",-1),Pc=Object(n["h"])("br",null,null,-1),Ec=Object(n["j"])("картридж в устройство "),Fc=[Hc,Ic,Uc,Tc,Pc,Ec],Vc=Object(n["h"])("div",{class:"icon-sync"},[Object(n["h"])("div",{class:"sync-bg"})],-1),Ac=Object(n["h"])("a",{href:"#",class:"btn-cancel"},"Отменить",-1);function Mc(e,t,c,i,s,a){return Object(n["w"])(),Object(n["g"])("div",null,[Object(n["h"])("div",mc,[yc,Object(n["h"])("div",wc,[1==e.activeStep?(Object(n["w"])(),Object(n["g"])("div",Dc,Nc)):Object(n["f"])("",!0),2==e.activeStep?(Object(n["w"])(),Object(n["g"])("div",xc,Fc)):Object(n["f"])("",!0),Object(n["h"])("a",{href:"#",class:Object(n["q"])(["btn-sync",e.connectDeviceInProcess?"syncing":""]),onClick:t[0]||(t[0]=function(t){return e.startFindDevice()})},[Vc,Object(n["h"])("span",null,Object(n["E"])(1==e.deviceConnect?"Подключено":"Подключить"),1)],2),Ac])])])}var qc=Object(n["l"])({name:"sync",setup:function(){var e=this,t=Object(Q["b"])(),c=Object(Y["c"])(),i=Object(n["z"])(1),s=Object(n["c"])((function(){return t.state.connectDeviceInProcess})),a=Object(n["c"])((function(){return t.state.deviceConnect})),r=function(){return Object(J["a"])(e,void 0,void 0,(function(){return Object(J["b"])(this,(function(e){switch(e.label){case 0:return[4,t.dispatch("connectPlonq")];case 1:return e.sent(),c.push({name:"Main"}),[2]}}))}))};return{activeStep:i,startFindDevice:r,connectDeviceInProcess:s,deviceConnect:a}}});const _c=Z()(qc,[["render",Mc]]);var Wc=_c,zc=[{path:"/",name:"Main",component:He},{path:"/stats",name:"Stats",component:tc},{path:"/settings",name:"Settings",component:Be},{path:"/system",name:"System",component:st},{path:"/firmware-update",name:"FirmwareUpdate",component:Rt},{path:"/onboard",name:"Onboard",component:gc},{path:"/sync",name:"Sync",component:Wc}],Bc=Object(Y["a"])({history:Object(Y["b"])("/"),routes:zc}),Rc=Bc,$c=function(){function e(){this.deviceDetail={firmware:null,firmwareVersion:null,hardware:null,deviceName:null,deviceModel:null,batteryLevel:0,chargeStatus:!1,puffCounter:0,unixtime:0,mac:null,cartridge:0,tx:null},this.servicesList={deviceInfo:"device_information",deviceInfoUUID:"0000180a-0000-1000-8000-00805f9b34fb",deviceInfoIOS:6154,battery:"0000180f-0000-1000-8000-00805f9b34fb",batteryIOS:6159,service:"00005523-1212-efde-1523-785feabcd133",nordic:"6e400001-b5a3-f393-e0a9-e50e24dcca9e"},this.charsList={firmware:"00002a26-0000-1000-8000-00805f9b34fb",firmwareIOS:10790,firmwareVersion:"00001560-1212-efde-1523-785feabcd133",hardware:"00002a27-0000-1000-8000-00805f9b34fb",hardwareIOS:10791,deviceName:"00002a29-0000-1000-8000-00805f9b34fb",deviceNameIOS:10793,deviceModel:"00002a24-0000-1000-8000-00805f9b34fb",deviceModelIOS:10788,batteryLevel:"00002a19-0000-1000-8000-00805f9b34fb",batteryLevelIOS:10777,charge:"00001540-1212-efde-1523-785feabcd133",puffCounter:"00001235-1212-efde-1523-785feabcd133",unixtime:"00001526-1212-efde-1523-785feabcd133",mac:"00001570-1212-efde-1523-785feabcd133",cartridge:"00001580-1212-efde-1523-785feabcd133",rx:"6e400002-b5a3-f393-e0a9-e50e24dcca9e",tx:"6e400003-b5a3-f393-e0a9-e50e24dcca9e",nordicWrite:"6e400042-b5a3-f393-e0a9-e50e24dcca9e",nordicRead:"6e400043-b5a3-f393-e0a9-e50e24dcca9e"},this.servicesHandle={deviceInfo:null,battery:null,service:null,nordic:null},this.charsHandle={deviceInfo:{firmware:null,hardware:null,deviceName:null,deviceModel:null},battery:{batteryLevel:null,batteryLevelNotify:null},service:{charge:null,chargeNotify:null,puffCounter:null,puffCounterNotify:null,unixtime:null,unixtimeNotify:null,firmwareVersion:null,mac:null,cartridge:null,cartridgeNotify:null},nordic:{rx:null,tx:null,txNotify:null,nordicWrite:null,nordicRead:null}},this.tsNavigator=window.navigator}return e.prototype.request=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t,c;return Object(J["b"])(this,(function(n){switch(n.label){case 0:if(e={filters:[{name:"DfuTarg"},{name:"PLONQ"},{namePrefix:"DfuTarg"},{namePrefix:"PLONQ"}],optionalServices:[this.servicesList.deviceInfo,this.servicesList.battery,this.servicesList.service,this.servicesList.nordic,6154,6159]},void 0==this.tsNavigator.bluetooth)return alert("Данное приложение не поддерживает необходимые для работы технологии"),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),t=this,[4,this.tsNavigator.bluetooth.requestDevice(e)];case 2:return t.device=n.sent(),[3,4];case 3:return c=n.sent(),console.log("error requestDevice"),console.log(c),[3,4];case 4:if(!this.device)throw"Устройство не выбрано";return[2]}}))}))},e.prototype.testNordic=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t,c,n,i;return Object(J["b"])(this,(function(s){switch(s.label){case 0:return console.log("------- NORDIC -----------"),[4,this.server.getPrimaryService("6e400001-b5a3-f393-e0a9-e50e24dcca9e")];case 1:return e=s.sent(),console.log(e),[4,e.getCharacteristics()];case 2:t=s.sent(),c=0,n=t,s.label=3;case 3:return c<n.length?(i=n[c],console.log(i.uuid),"6e400042-b5a3-f393-e0a9-e50e24dcca9e"!==i.uuid?[3,5]:[4,i.writeValue(new Uint8Array([85]))]):[3,6];case 4:return s.sent(),[3,6];case 5:return c++,[3,3];case 6:return console.log("--------- END ------------"),[2]}}))}))},e.prototype.getServices=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t,c,n;return Object(J["b"])(this,(function(i){switch(i.label){case 0:if(!this.device)throw"Устройство не выбрано";return e=this,[4,this.server.getPrimaryServices()];case 1:for(e.services=i.sent(),t=0,c=this.services;t<c.length;t++)switch(n=c[t],console.log("Service: "+n.uuid),n.uuid){case this.servicesList.deviceInfoUUID:this.servicesHandle.deviceInfo=n;break;case this.servicesList.deviceInfoIOS:this.servicesHandle.deviceInfo=n;break;case this.servicesList.battery:console.log("battery found"),console.log(n),console.log("----------------------"),console.log(JSON.stringify(this.servicesHandle)),this.servicesHandle.battery=n;break;case this.servicesList.batteryIOS:this.servicesHandle.battery=n;break;case this.servicesList.service:this.servicesHandle.service=n;break;case this.servicesList.nordic:this.servicesHandle.nordic=n,console.log("nordic found"),console.log(n),console.log("----------------------"),console.log(JSON.stringify(this.servicesHandle)),console.log("----------------------"),console.log(this.servicesHandle.nordic),console.log("----------------------");break;default:console.log("Неизвестный сервис "+n.uuid);break}return console.log(this.servicesHandle),console.log(JSON.stringify(this.servicesHandle)),[2]}}))}))},e.prototype.getChars=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t,c,n,i,s,a,r,o,l,u,d,v,b,h,f,j,p,O,g,m,y,w,D,C,S,k,L,N,x,H,I,U,T,P,E,F,V,A,M,q;return Object(J["b"])(this,(function(_){switch(_.label){case 0:e=new TextDecoder("utf-8"),t=[this.servicesHandle.deviceInfo,this.servicesHandle.battery,this.servicesHandle.service,this.servicesHandle.nordic],c=0,n=t,_.label=1;case 1:if(!(c<n.length))return[3,71];switch(i=n[c],s=i.uuid,s){case this.servicesHandle.deviceInfo.uuid:return[3,2];case this.servicesHandle.battery.uuid:return[3,26];case this.servicesHandle.service.uuid:return[3,38];case this.servicesHandle.nordic.uuid:return[3,58]}return[3,70];case 2:return _.trys.push([2,24,,25]),[4,i.getCharacteristics()];case 3:P=_.sent(),a=0,r=P,_.label=4;case 4:if(!(a<r.length))return[3,23];switch(V=r[a],o=V.uuid,o){case this.charsList.firmware:return[3,5];case this.charsList.hardware:return[3,7];case this.charsList.deviceName:return[3,9];case this.charsList.deviceModel:return[3,11];case this.charsList.firmwareIOS:return[3,13];case this.charsList.hardwareIOS:return[3,15];case this.charsList.deviceNameIOS:return[3,17];case this.charsList.deviceModelIOS:return[3,19]}return[3,21];case 5:return this.charsHandle.deviceInfo.firmware=V,l=this.deviceDetail,[4,V.readValue().then((function(t){return e.decode(t)}))];case 6:return l.firmware=_.sent(),console.log("Версия прошивки: "+this.deviceDetail.firmware),[3,22];case 7:return this.charsHandle.deviceInfo.hardware=V,u=this.deviceDetail,[4,V.readValue().then((function(t){return e.decode(t)}))];case 8:return u.hardware=_.sent(),console.log("Версия устройства: "+this.deviceDetail.hardware),[3,22];case 9:return this.charsHandle.deviceInfo.deviceName=V,d=this.deviceDetail,[4,V.readValue().then((function(t){return e.decode(t)}))];case 10:return d.deviceName=_.sent(),console.log("Имя устройства: "+this.deviceDetail.deviceName),[3,22];case 11:return this.charsHandle.deviceInfo.deviceModel=V,v=this.deviceDetail,[4,V.readValue().then((function(t){return e.decode(t)}))];case 12:return v.deviceModel=_.sent(),console.log("Модель устройства: "+this.deviceDetail.deviceModel),[3,22];case 13:return this.charsHandle.deviceInfo.firmware=V,b=this.deviceDetail,[4,V.readValue().then((function(t){return e.decode(t)}))];case 14:return b.firmware=_.sent(),console.log("Версия прошивки IOS: "+this.deviceDetail.firmware),[3,22];case 15:return this.charsHandle.deviceInfo.hardware=V,h=this.deviceDetail,[4,V.readValue().then((function(t){return e.decode(t)}))];case 16:return h.hardware=_.sent(),console.log("Версия устройства IOS: "+this.deviceDetail.hardware),[3,22];case 17:return this.charsHandle.deviceInfo.deviceName=V,f=this.deviceDetail,[4,V.readValue().then((function(t){return e.decode(t)}))];case 18:return f.deviceName=_.sent(),console.log("Имя устройства IOS: "+this.deviceDetail.deviceName),[3,22];case 19:return this.charsHandle.deviceInfo.deviceModel=V,j=this.deviceDetail,[4,V.readValue().then((function(t){return e.decode(t)}))];case 20:return j.deviceModel=_.sent(),console.log("Модель устройства IOS: "+this.deviceDetail.deviceModel),[3,22];case 21:return console.log("Неизвестная характеристика "+V.uuid),[3,22];case 22:return a++,[3,4];case 23:return[3,25];case 24:return p=_.sent(),console.log("Ошибка при получении списка характеристик"),console.log(p),[3,25];case 25:return[3,70];case 26:return _.trys.push([26,36,,37]),[4,i.getCharacteristics()];case 27:P=_.sent(),O=0,g=P,_.label=28;case 28:if(!(O<g.length))return[3,35];switch(V=g[O],m=V.uuid,m){case this.charsList.batteryLevel:return[3,29];case this.charsList.batteryLevelIOS:return[3,31]}return[3,33];case 29:return this.charsHandle.battery.batteryLevel=V,y=this.deviceDetail,[4,V.readValue().then((function(e){return e.getUint8()}))];case 30:return y.batteryLevel=_.sent(),console.log("Заряд батареи: "+this.deviceDetail.batteryLevel+"%"),[3,34];case 31:return this.charsHandle.battery.batteryLevel=V,w=this.deviceDetail,[4,V.readValue().then((function(e){return e.getUint8()}))];case 32:return w.batteryLevel=_.sent(),console.log("Заряд батареи IOS: "+this.deviceDetail.batteryLevel+"%"),[3,34];case 33:return console.log("Неизвестная характеристика "+V.uuid),[3,34];case 34:return O++,[3,28];case 35:return[3,37];case 36:return D=_.sent(),console.log("Ошибка при получении списка характеристик"),console.log(D),[3,37];case 37:return[3,70];case 38:return _.trys.push([38,56,,57]),[4,i.getCharacteristics()];case 39:P=_.sent(),C=0,S=P,_.label=40;case 40:if(!(C<S.length))return[3,55];switch(V=S[C],k=V.uuid,k){case this.charsList.charge:return[3,41];case this.charsList.puffCounter:return[3,43];case this.charsList.unixtime:return[3,45];case this.charsList.firmwareVersion:return[3,47];case this.charsList.mac:return[3,49];case this.charsList.cartridge:return[3,51]}return[3,53];case 41:return this.charsHandle.service.charge=V,L=this.deviceDetail,[4,V.readValue().then((function(e){return e.getUint8()}))];case 42:return L.charge=_.sent(),console.log("Статус зарядки: "+this.deviceDetail.charge),[3,54];case 43:return this.charsHandle.service.puffCounter=V,N=this.deviceDetail,[4,V.readValue().then((function(e){return e.getUint8()}))];case 44:return N.puffCounter=_.sent(),console.log("Количество затяжек: "+this.deviceDetail.puffCounter),[3,54];case 45:return this.charsHandle.service.unixtime=V,x=this.deviceDetail,[4,V.readValue().then((function(e){return e.getUint32()}))];case 46:return x.unixtime=_.sent(),console.log("Время на устройстве: "+this.deviceDetail.unixtime),[3,54];case 47:return this.charsHandle.service.firmwareVersion=V,H=this.deviceDetail,[4,V.readValue().then((function(e){return e.getUint8()}))];case 48:return H.firmwareVersion=_.sent(),console.log("Версия прошивки Legacy: "+this.deviceDetail.firmwareVersion),[3,54];case 49:return this.charsHandle.service.mac=V,I=this.deviceDetail,[4,V.readValue().then((function(e){var t=new Uint8Array(e.buffer).map((function(e){return parseInt(e,10)})),c=[];for(var n in t){var i=Number(t[n]).toString(16);i.length<2&&(i+="0",i=i.split("").reverse().join("")),c.push(i)}return c.join(":").toUpperCase()}))];case 50:return I.mac=_.sent(),console.log("MAC: "+this.deviceDetail.mac),[3,54];case 51:return this.charsHandle.service.cartridge=V,U=this.deviceDetail,[4,V.readValue().then((function(e){return e.getUint8()}))];case 52:return U.cartridge=_.sent(),console.log("Cartridge: "+this.deviceDetail.cartridge),[3,54];case 53:return console.log("Неизвестная характеристика "+V.uuid),[3,54];case 54:return C++,[3,40];case 55:return[3,57];case 56:return T=_.sent(),console.log("Ошибка при получении списка характеристик"),console.log(T),[3,57];case 57:return[3,70];case 58:return _.trys.push([58,68,,69]),[4,i.getCharacteristics()];case 59:P=_.sent(),E=0,F=P,_.label=60;case 60:if(!(E<F.length))return[3,67];switch(V=F[E],A=V.uuid,A){case this.charsList.nordicWrite:return[3,61];case this.charsList.nordicRead:return[3,62];case this.charsList.tx:return[3,63]}return[3,65];case 61:return this.charsHandle.nordic.nordicWrite=V,[3,66];case 62:return this.charsHandle.nordic.nordicRead=V,[3,66];case 63:return this.charsHandle.nordic.tx=V,M=this.deviceDetail,[4,V.readValue().then((function(e){return e.getUint8()}))];case 64:return M.tx=_.sent(),[3,66];case 65:return console.log("Неизвестная характеристика "+V.uuid),[3,66];case 66:return E++,[3,60];case 67:return[3,69];case 68:return q=_.sent(),console.log("Ошибка при получении списка характеристик"),console.log(q),[3,69];case 69:return[3,70];case 70:return c++,[3,1];case 71:return[2]}}))}))},e.prototype.startCommand=function(e){return Object(J["a"])(this,void 0,void 0,(function(){var t,c;return Object(J["b"])(this,(function(n){switch(n.label){case 0:if(!this.device)return console.log("Устройство не подключено"),[2,!1];n.label=1;case 1:return n.trys.push([1,3,,4]),console.log("go go"),console.log("++++++++++++ this.charsHandle +++++++++++++"),console.log(this.charsHandle),console.log("++++++++++++ this.charsHandle.nordic ++++ "),console.log(this.charsHandle.nordic),console.log("++++++++++++ this.charsHandle.nordic.nordicWrite ++++ "),console.log(this.charsHandle.nordic.nordicWrite),[4,this.charsHandle.nordic.nordicWrite.writeValue(new Uint8Array([e]))];case 2:return t=n.sent(),console.log("# ~ Пишет "+e+" в NORDIC"),console.log(t),[3,4];case 3:return c=n.sent(),console.log(c),[3,4];case 4:return[2]}}))}))},e.prototype.connect=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t;return Object(J["b"])(this,(function(c){switch(c.label){case 0:if(!this.device)return[2,Promise.reject("Устройство не подключено")];c.label=1;case 1:return c.trys.push([1,5,,6]),e=this,[4,this.device.gatt.connect()];case 2:return e.server=c.sent(),console.log("Подключились к серверу GATT"),[4,this.getServices()];case 3:return c.sent(),[4,this.getChars()];case 4:return c.sent(),console.log("Устройство подключено"),[2,{connected:!0}];case 5:return t=c.sent(),console.log(t),[2,{connected:!1}];case 6:return[2]}}))}))},e.prototype.disconnect=function(){return this.device?(this.device.gatt.disconnect(),{connected:!1}):Promise.reject("Отключаем устройство")},e}(),Gc=$c,Jc=c("bc3a"),Qc=c.n(Jc),Yc=Object(Q["a"])({state:{terminal:new Array,onboard:!1,slideupConfirmAge:!1,slideupSelectDevice:!1,slideupConnectDevice:!1,statusUpdateNow:!1,deviceConnect:!1,deviceDetail:{firmware:"",firmwareVersion:"",hardware:"",deviceName:"",deviceModel:"",batteryLevel:0,chargeStatus:!1,puffCounter:0,unixtime:0,mac:"",cartridge:0,tx:null},notifyTooltip:{status:!1,message:null,icon:null},plonq:{},firmwareToken:null,firmwareData:{version:"",file:"",charges:""},connectDeviceInProcess:!1,alertUpdateStatus:!1},mutations:{setSlideupConnectDevice:function(e,t){e.slideupConnectDevice=t},setAlertUpdateStatus:function(e,t){e.alertUpdateStatus=t},setFirmwareToken:function(e,t){e.firmwareToken=t},setFirmwareData:function(e,t){e.firmwareData=t},setPlonqHandle:function(e,t){e.plonq=t},setStartNotifyTooltip:function(e,t){e.notifyTooltip.status=!0,e.notifyTooltip.message=t.message,e.notifyTooltip.icon=t.icon},setStopNotifyTooltip:function(e){e.notifyTooltip.status=!1},setConnectDeviceInProcess:function(e,t){e.connectDeviceInProcess=t},setDeviceConnect:function(e,t){e.deviceConnect=t},setDeviceDetail:function(e,t){e.deviceDetail=t},setPuffCount:function(e,t){e.deviceDetail.puffCounter=t},setChargeStatus:function(e,t){e.deviceDetail.chargeStatus=t},setBatteryLevel:function(e,t){e.deviceDetail.batteryLevel=t},setCartridge:function(e,t){e.deviceDetail.cartridge=t}},actions:{firmwareServerRegistration:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var e,c,n;return Object(J["b"])(this,(function(i){switch(i.label){case 0:if(!t)return[3,4];e=new FormData,e.append("username",t),e.append("el_cigarette_id","1"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Qc()({url:"https://ponq.ru:8000/rest-auth/registration/",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})];case 2:return c=i.sent().data,Object.keys(c).includes("key")?[2,c]:[3,4];case 3:return n=i.sent(),console.log("Ошибка регистрации"),[2,n];case 4:return[2]}}))}))},firmwareServerLogin:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var e,c,n;return Object(J["b"])(this,(function(i){switch(i.label){case 0:if(!t)return[3,4];e=new FormData,e.append("username",t),e.append("el_cigarette_id","1"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Qc()({url:"https://ponq.ru:8000/rest-auth/login/",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})];case 2:return c=i.sent().data,Object.keys(c).includes("key")?[2,c]:[3,4];case 3:return n=i.sent(),console.log("Ошибка авторизации"),[2,n];case 4:return[2]}}))}))},firmwareServerAutoLogin:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var c,n;return Object(J["b"])(this,(function(i){switch(i.label){case 0:return[4,e.dispatch("firmwareServerRegistration",t)];case 1:return c=i.sent(),Object.keys(c).includes("key")?(e.commit("setFirmwareToken",c.key),console.log("Регистрация: "+c.key),[2,c.key]):[3,2];case 2:return[4,e.dispatch("firmwareServerLogin",t)];case 3:return n=i.sent(),Object.keys(n).includes("key")?(e.commit("setFirmwareToken",n.key),console.log("Авторизация: "+n.key),[2,n.key]):[2,!1]}}))}))},getLastFirmwareVersion:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var c;return Object(J["b"])(this,(function(n){switch(n.label){case 0:return[4,Qc()({url:"https://ponq.ru:8000/user/device/firmware/",method:"get",headers:{Authorization:"Token "+t}})];case 1:return c=n.sent().data,Object.keys(c).includes("version")?(e.commit("setFirmwareData",c),console.log(c),[2,c]):(console.log("Не удалось получить версию прошивки"),[2,c])}}))}))},initDataFirmware:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var c;return Object(J["b"])(this,(function(n){switch(n.label){case 0:return[4,e.dispatch("firmwareServerAutoLogin",t)];case 1:return c=n.sent(),c?[4,e.dispatch("getLastFirmwareVersion",c)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2,!0]}}))}))},startNotifyTooltip:function(e,t){var c=t.message,n=t.icon;return Object(J["a"])(this,void 0,void 0,(function(){return Object(J["b"])(this,(function(t){return e.commit("setStartNotifyTooltip",{message:c,icon:n}),setTimeout((function(){return e.commit("setStopNotifyTooltip")}),2700),[2]}))}))},connectPlonq:function(e){return Object(J["a"])(this,void 0,void 0,(function(){var t,c,n,i,s,a,r,o;return Object(J["b"])(this,(function(l){switch(l.label){case 0:console.log("Запускаем подключение.."),t=new Gc,e.commit("setPlonqHandle",t),l.label=1;case 1:l.trys.push([1,11,,12]),e.commit("setConnectDeviceInProcess",!0),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,t.request()];case 3:return l.sent(),[3,5];case 4:return c=l.sent(),console.log(c),[3,5];case 5:return[4,t.connect()];case 6:return n=l.sent(),console.log(t.device),n.connected?(e.commit("setDeviceConnect",!0),s=(i=e).commit,a=["setDeviceDetail"],[4,t.deviceDetail]):[3,9];case 7:return s.apply(i,a.concat([l.sent()])),e.commit("setConnectDeviceInProcess",!1),console.log(e.state.deviceDetail),console.log(e.state.deviceDetail.deviceName),r=e.state.deviceDetail.mac.replace(":","-"),[4,e.dispatch("initDataFirmware",r)];case 8:l.sent(),setTimeout((function(){var t=(e.state.deviceDetail.deviceName+" "+e.state.deviceDetail.deviceModel).toUpperCase();setTimeout((function(){e.dispatch("startNotifyTooltip",{message:t+" подключён",icon:"device"})}),600)}),600),setTimeout((function(){var t=e.state.deviceDetail.firmware,c=e.state.firmwareData.version;t!==c&&e.commit("setAlertUpdateStatus",!0)}),3200),l.label=9;case 9:return console.log("-------------------------------"),console.log(e.state.deviceDetail),t.device.addEventListener("gattserverdisconnected",(function(c){return Object(J["a"])(this,void 0,void 0,(function(){var c,n,i,s=this;return Object(J["b"])(this,(function(a){return console.log("Дисконнент"),e.commit("setDeviceConnect",!1),c=(e.state.deviceDetail.deviceName+" "+e.state.deviceDetail.deviceModel).toUpperCase(),e.dispatch("startNotifyTooltip",{message:c+" отключён",icon:"device"}),n={connected:!1},i=setInterval((function(){return Object(J["a"])(s,void 0,void 0,(function(){var c,s,a;return Object(J["b"])(this,(function(r){switch(r.label){case 0:return[4,t.connect()];case 1:return n=r.sent(),n["connected"]?(e.commit("setDeviceConnect",!0),s=(c=e).commit,a=["setDeviceDetail"],[4,t.deviceDetail]):[3,4];case 2:return s.apply(c,a.concat([r.sent()])),[4,e.dispatch("startGattNotify",t)];case 3:return r.sent(),e.dispatch("startNotifyTooltip",{message:"Подключение восстановлено",icon:"device"}),clearInterval(i),[3,5];case 4:e.commit("setDeviceConnect",!0),e.commit("setSlideupConnectDevice",!0),r.label=5;case 5:return[2]}}))}))}),3e3),[2]}))}))})),[4,e.dispatch("startGattNotify",t)];case 10:return l.sent(),[3,12];case 11:return o=l.sent(),e.commit("setConnectDeviceInProcess",!1),console.log(o),console.log("Ошибка подключения к устройству"),[3,12];case 12:return[2]}}))}))},startGattNotify:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var c,n,i,s;return Object(J["b"])(this,(function(a){switch(a.label){case 0:console.log("Start dispatch events.."),console.log("PUFF EVENT"),console.log(t.charsHandle.service.puffCounter),a.label=1;case 1:return a.trys.push([1,3,,4]),t.charsHandle.service.puffCounter.addEventListener("characteristicvaluechanged",(function(t){var c=t.target.value.getUint8();e.commit("setPuffCount",c),console.log("> Event puff count is "+c),e.state.terminal.push("Событие затяжки: "+c+" (кол-во)")})),[4,t.charsHandle.service.puffCounter.startNotifications()];case 2:return a.sent(),[3,4];case 3:return c=a.sent(),console.log("error puff event"),console.log(c),[3,4];case 4:return a.trys.push([4,6,,7]),t.charsHandle.service.charge.addEventListener("characteristicvaluechanged",(function(t){var c=t.target.value.getUint8();e.commit("setChargeStatus",c),console.log("> Charge status "+c),e.state.terminal.push("Событие зарядки: "+c),c?e.dispatch("startNotifyTooltip",{message:"Зарядка подключена",icon:"charge"}):e.dispatch("startNotifyTooltip",{message:"Зарядка отключена",icon:"charge"})})),[4,t.charsHandle.service.charge.startNotifications()];case 5:return a.sent(),[3,7];case 6:return n=a.sent(),console.log(n),[3,7];case 7:return a.trys.push([7,9,,10]),t.charsHandle.battery.batteryLevel.addEventListener("characteristicvaluechanged",(function(t){var c=t.target.value.getUint8();e.commit("setBatteryLevel",c),console.log("> Заряд батареи "+c),e.state.terminal.push("Событие батареи: "+c+"%"),c<10&&e.dispatch("startNotifyTooltip",{message:"Требуется зарядка",icon:"charge"})})),[4,t.charsHandle.battery.batteryLevel.startNotifications()];case 8:return a.sent(),[3,10];case 9:return i=a.sent(),console.log(i),[3,10];case 10:return a.trys.push([10,12,,13]),t.charsHandle.service.cartridge.addEventListener("characteristicvaluechanged",(function(t){var c=t.target.value.getUint8();e.commit("setCartridge",c),console.log("> Картридж "+c),e.state.terminal.push("Событие картриджа: "+c),c>0?e.dispatch("startNotifyTooltip",{message:"Картридж подключён",icon:"tasty"}):e.dispatch("startNotifyTooltip",{message:"Картридж отключён",icon:"tasty"})})),[4,t.charsHandle.service.cartridge.startNotifications()];case 11:return a.sent(),[3,13];case 12:return s=a.sent(),console.log(s),[3,13];case 13:return[2]}}))}))}},modules:{}});Object(n["d"])(te).use(Yc).use(Rc).mount("#app")},d66f:function(e,t,c){},dff7:function(e,t,c){},e24e:function(e,t,c){"use strict";c("dff7")},ee16:function(e,t,c){e.exports=c.p+"img/tasty.976f0e64.svg"},f92f:function(e,t,c){e.exports=c.p+"img/device-silver.fb96dede.png"},fd19:function(e,t,c){e.exports=c.p+"img/icon-main.18bee816.svg"}});
//# sourceMappingURL=app.20a5f94a.js.map