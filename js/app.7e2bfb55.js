(function(e){function t(t){for(var i,a,r=t[0],o=t[1],l=t[2],d=0,v=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&v.push(n[a][0]),n[a]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);u&&u(t);while(v.length)v.shift()();return s.push.apply(s,l||[]),c()}function c(){for(var e,t=0;t<s.length;t++){for(var c=s[t],i=!0,r=1;r<c.length;r++){var o=c[r];0!==n[o]&&(i=!1)}i&&(s.splice(t--,1),e=a(a.s=c[0]))}return e}var i={},n={app:0},s=[];function a(t){if(i[t])return i[t].exports;var c=i[t]={i:t,l:!1,exports:{}};return e[t].call(c.exports,c,c.exports,a),c.l=!0,c.exports}a.m=e,a.c=i,a.d=function(e,t,c){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:c})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(c,i,function(t){return e[t]}.bind(null,i));return c},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=o;s.push([0,"chunk-vendors"]),c()})({0:function(e,t,c){e.exports=c("cd49")},"05f9":function(e,t,c){e.exports=c.p+"img/icon-done.8a4d0806.svg"},"07ae":function(e,t,c){},"141a":function(e,t,c){e.exports=c.p+"img/icon-flash.062da934.svg"},1780:function(e,t,c){e.exports=c.p+"img/app_general.f9d3f6a7.png"},"1ae4":function(e,t,c){e.exports=c.p+"img/logo.c8f7a560.svg"},"23b6":function(e,t,c){"use strict";c("d66f")},"2de5":function(e,t,c){e.exports=c.p+"img/app_slide_stats.ca7e5757.png"},3394:function(e,t,c){},"39c0":function(e,t,c){e.exports=c.p+"img/sync-black.911d7996.svg"},"39df":function(e,t,c){e.exports=c.p+"img/icon-stats.33457b82.svg"},4374:function(e,t,c){"use strict";c("3394")},"49b9":function(e,t,c){e.exports=c.p+"img/icon-add-device.429e9335.svg"},"4eca":function(e,t,c){e.exports=c.p+"img/app_slide_slow.c78d0ec9.png"},6749:function(e,t,c){var i,n,s;(function(a,r){n=[c("c4e3")],i=r,s="function"===typeof i?i.apply(t,n):i,void 0===s||(e.exports=s)})(0,(function(e){"use strict";function t(e){this.buffer=e,this.zipFile=null,this.manifest=null}return t.prototype.load=function(){return e.loadAsync(this.buffer).then(e=>{this.zipFile=e;try{return this.zipFile.file("manifest.json").async("string")}catch(t){throw new Error("Unable to find manifest, is this a proper DFU package?")}}).then(e=>(this.manifest=JSON.parse(e).manifest,this))},t.prototype.getImage=function(e){for(var t of e)if(this.manifest[t]){var c=this.manifest[t],i={type:t,initFile:c.dat_file,imageFile:c.bin_file};return this.zipFile.file(i.initFile).async("arraybuffer").then(e=>(i.initData=e,this.zipFile.file(i.imageFile).async("arraybuffer"))).then(e=>(i.imageData=e,i))}},t.prototype.getBaseImage=function(){return this.getImage(["softdevice","bootloader","softdevice_bootloader"])},t.prototype.getAppImage=function(){return this.getImage(["application"])},t}))},6856:function(e,t,c){},7940:function(e,t,c){"use strict";c("6856")},8410:function(e,t,c){e.exports=c.p+"img/battery.a97f5aa7.svg"},abe1:function(e,t,c){e.exports=c.p+"img/icon-error.d211846a.svg"},b08a:function(e,t,c){e.exports=c.p+"img/icon-settings.1fafe628.svg"},c611:function(e,t,c){e.exports=c.p+"img/icon-arrow-down.65765fac.svg"},ca8a:function(e,t,c){"use strict";c("07ae")},ca9f:function(e,t,c){e.exports=c.p+"img/bluetooth.9d93a16a.svg"},cd49:function(e,t,c){"use strict";c.r(t);var i=c("7a23"),n=c("c611"),s=c.n(n),a=c("ca9f"),r=c.n(a),o=c("8410"),l=c.n(o),u=c("ee16"),d=c.n(u),v=c("fd19"),b=c.n(v),f=c("39df"),g=c.n(f),h=c("b08a"),p=c.n(h),O=c("141a"),j=c.n(O),m={class:"wrapper"},y={class:"over-18"},w=Object(i["g"])("div",{class:"title"},[Object(i["i"])("Вам уже"),Object(i["g"])("br"),Object(i["i"])("есть 18 лет?")],-1),C=Object(i["g"])("div",{class:"description"},[Object(i["i"])("Я подтверждаю, что мне"),Object(i["g"])("br"),Object(i["i"])("исполнилось 18 лет")],-1),D={class:"btn-group"},S=Object(i["g"])("div",{class:"bg-filter"},null,-1),k={key:0,class:"alert-update"},L={class:"content"},N=Object(i["g"])("div",{class:"title"},[Object(i["i"])("Доступно"),Object(i["g"])("br"),Object(i["i"])("обновление")],-1),x={class:"total-version"},I=Object(i["g"])("span",null,"Текущая версия",-1),U={class:"version"},T=Object(i["g"])("div",{class:"icon-arrow"},[Object(i["g"])("img",{src:s.a})],-1),P={class:"new-version"},H={class:"version"},F=Object(i["g"])("span",null,"Новая версия",-1),V=Object(i["g"])("div",{class:"bg-filter"},null,-1),A={class:"icon"},M={key:0,src:r.a},_={key:1,src:l.a},q={key:2,src:d.a},E={class:"text"},R={key:0,class:"main-menu"},W=Object(i["g"])("img",{src:b.a},null,-1),B=Object(i["g"])("img",{src:g.a},null,-1),$=Object(i["g"])("img",{src:p.a},null,-1),z=Object(i["g"])("img",{src:j.a},null,-1);function G(e,t,c,n,s,a){var r=Object(i["z"])("router-view"),o=Object(i["z"])("router-link");return Object(i["v"])(),Object(i["f"])("div",null,[Object(i["g"])("div",m,[Object(i["j"])(r,null,{default:Object(i["F"])((function(t){var c=t.Component;return[Object(i["j"])(i["a"],{name:"slide-fade",mode:"out-in"},{default:Object(i["F"])((function(){return[(Object(i["v"])(),Object(i["d"])(Object(i["A"])(c),{key:e.$router.path}))]})),_:2},1024)]})),_:1})]),Object(i["g"])("div",{class:Object(i["p"])(["slideup",1==e.slideupConfirmAge?"activate":"deactivate"])},[Object(i["g"])("div",y,[w,C,Object(i["g"])("div",D,[Object(i["g"])("a",{href:"#",class:"btn active",onClick:t[0]||(t[0]=function(t){return e.slideupConfirmAgeStatus(!0,t)})},"Да"),Object(i["g"])("a",{href:"#",class:"btn",onClick:t[1]||(t[1]=function(t){return e.slideupConfirmAgeStatus(!1,t)})},"Нет")])]),S],2),Object(i["j"])(i["a"],{name:"slide-fadeup",mode:"out-in"},{default:Object(i["F"])((function(){return[e.alertUpdateStatus?(Object(i["v"])(),Object(i["f"])("div",k,[Object(i["g"])("div",L,[N,Object(i["g"])("div",x,[I,Object(i["g"])("div",U,Object(i["C"])(e.fwCurrentVersion),1)]),T,Object(i["g"])("div",P,[Object(i["g"])("div",H,Object(i["C"])(e.fwServerVersion),1),F]),Object(i["g"])("div",{class:"btn-update",onClick:t[2]||(t[2]=function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];return e.alertUpdateGo&&e.alertUpdateGo.apply(e,t)})},"Обновить"),Object(i["g"])("div",{class:"btn-cancel",onClick:t[3]||(t[3]=function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];return e.alertUpdateCancel&&e.alertUpdateCancel.apply(e,t)})},"Обновить позже")]),V])):Object(i["e"])("",!0)]})),_:1}),Object(i["g"])("div",{class:Object(i["p"])(["tooltip-notify",e.notifyTooltip.status?"activate":""])},[Object(i["g"])("div",A,["device"==e.notifyTooltip.icon?(Object(i["v"])(),Object(i["f"])("img",M)):Object(i["e"])("",!0),"charge"==e.notifyTooltip.icon?(Object(i["v"])(),Object(i["f"])("img",_)):Object(i["e"])("",!0),"tasty"==e.notifyTooltip.icon?(Object(i["v"])(),Object(i["f"])("img",q)):Object(i["e"])("",!0)]),Object(i["g"])("div",E,Object(i["C"])(e.notifyTooltip.message),1)],2),Object(i["j"])(i["a"],{name:"slide-fade",mode:"out-in"},{default:Object(i["F"])((function(){return["Main"==e.$router.currentRoute.value.name||"Stats"==e.$router.currentRoute.value.name||"Settings"==e.$router.currentRoute.value.name||"System"==e.$router.currentRoute.value.name?(Object(i["v"])(),Object(i["f"])("div",R,[Object(i["j"])(o,{to:"/"},{default:Object(i["F"])((function(){return[W]})),_:1}),Object(i["j"])(o,{to:"/stats"},{default:Object(i["F"])((function(){return[B]})),_:1}),Object(i["j"])(o,{to:"/settings"},{default:Object(i["F"])((function(){return[$]})),_:1}),Object(i["j"])(o,{to:"/system"},{default:Object(i["F"])((function(){return[z]})),_:1})])):Object(i["e"])("",!0)]})),_:1})])}var J=c("9ab4"),Q=c("5502"),Y=c("6c02"),K=Object(i["k"])({name:"App",setup:function(){var e=this,t=Object(Q["b"])(),c=Object(Y["c"])(),n=Object(i["b"])((function(){return t.state.alertUpdateStatus})),s=Object(i["b"])((function(){return t.state.slideupConfirmAge})),a=Object(i["b"])((function(){return t.state.connectDeviceInProcess})),r=Object(i["b"])((function(){return t.state.deviceConnect})),o=function(c){return Object(J["a"])(e,void 0,void 0,(function(){return Object(J["b"])(this,(function(e){switch(e.label){case 0:return[4,t.dispatch("connectPlonq")];case 1:return e.sent(),t.state.deviceConnect?(t.state.slideupConnectDevice=!1,l(c)):t.dispatch("startNotifyTooltip",{message:"Ошибка подключения",icon:"device"}),[2]}}))}))};function l(e){e.target.closest(".slideup").style.display="block",setTimeout((function(){e.target.closest(".slideup").style.display="none"}),600)}var u=function(e,i){1==e?(t.state.slideupConfirmAge=!1,l(i),setTimeout((function(){c.push({name:"Sync"})}),600)):window.location.href="http://localhost:8080"},d=Object(i["b"])((function(){return t.state.notifyTooltip})),v=function(){t.commit("setAlertUpdateStatus",!1)},b=function(){c.push({name:"FirmwareUpdate"}),t.commit("setAlertUpdateStatus",!1)},f=Object(i["b"])((function(){return t.state.deviceDetail.firmware})),g=Object(i["b"])((function(){return t.state.firmwareData.version})),h=Object(i["b"])((function(){return t.state.slideupConnectDevice})),p=Object(i["b"])((function(){return t.state.statusUpdateNow}));return Object(i["t"])((function(){0==t.state.onboard&&c.push({name:"Onboard"}),t.state.deviceDetail.firmware.length<1&&1==t.state.onboard&&(t.state.slideupConnectDevice=!0)})),{notifyTooltip:d,slideupConfirmAge:s,slideupConfirmAgeStatus:u,slideupClose:l,alertUpdateStatus:n,alertUpdateGo:b,alertUpdateCancel:v,fwCurrentVersion:f,fwServerVersion:g,slideupConnectDevice:h,connectPlonq:o,connectDeviceInProcess:a,deviceConnect:r,statusUpdateNow:p}}}),X=(c("4374"),c("6b0d")),Z=c.n(X);const ee=Z()(K,[["render",G]]);var te=ee,ce=c("1ae4"),ie=c.n(ce),ne={class:"main-page"},se={class:"header"},ae={class:"info"},re=Object(i["g"])("div",{class:"logo"},[Object(i["g"])("img",{src:ie.a})],-1),oe={class:"stats"},le={class:"item"},ue=Object(i["g"])("div",{class:"icon"},[Object(i["g"])("img",{src:r.a})],-1),de={class:"text"},ve={class:"item"},be=Object(i["g"])("div",{class:"icon"},[Object(i["g"])("img",{src:l.a})],-1),fe={class:"text"},ge={class:"item"},he=Object(i["g"])("div",{class:"icon"},[Object(i["g"])("img",{src:d.a})],-1),pe={class:"text"},Oe={class:"device"},je=Object(i["g"])("div",{class:"device-bg"},null,-1),me={class:"main-content"},ye=Object(i["g"])("div",{class:"today"},[Object(i["i"])("Сегодня "),Object(i["g"])("span",{class:"bold"},"30 июня")],-1),we={class:"counter-group"},Ce={class:"item-counter active"},De={class:"count count-today"},Se=Object(i["g"])("div",{class:"label"},"Затяжек",-1),ke=Object(i["g"])("div",{class:"item-counter"},[Object(i["g"])("div",{class:"count count-week"},"128"),Object(i["g"])("div",{class:"label"},[Object(i["i"])("Среднее за тоже время"),Object(i["g"])("br"),Object(i["i"])("(последние 7 дней)")])],-1);function Le(e,t,n,s,a,r){return Object(i["v"])(),Object(i["f"])("div",ne,[Object(i["g"])("div",se,[Object(i["g"])("div",ae,[re,Object(i["g"])("div",oe,[Object(i["g"])("div",le,[ue,Object(i["g"])("div",de,Object(i["C"])(e.deviceConnect?"Подключено":"Отключено"),1)]),Object(i["g"])("div",ve,[be,Object(i["g"])("div",fe,Object(i["C"])(e.deviceConnect?e.deviceDetail.batteryLevel:"0")+"%",1)]),Object(i["g"])("div",ge,[he,Object(i["g"])("div",pe,Object(i["C"])(e.getCartridge),1)])])]),Object(i["g"])("div",Oe,[Object(i["g"])("div",{class:"device-image",style:Object(i["q"])("background-image: url('"+c("f92f")+"')")},null,4),je])]),Object(i["g"])("div",me,[ye,Object(i["g"])("div",we,[Object(i["g"])("div",Ce,[Object(i["g"])("div",De,Object(i["C"])(e.puffCounter),1),Se]),ke])])])}var Ne=Object(i["k"])({name:"Main",setup:function(){var e=Object(Q["b"])(),t=Object(i["b"])((function(){return e.state.deviceConnect})),c=Object(i["b"])((function(){return e.state.deviceDetail})),n=Object(i["b"])((function(){var e=c.value.cartridge,t=null;switch(e){case 0:t="Нет картриджа";break;case 255:t="Технический";break;default:t="Новый вкус";break}return t})),s=Object(i["b"])((function(){return e.state.deviceDetail.puffCounter}));return{deviceConnect:t,deviceDetail:c,getCartridge:n,puffCounter:s}}});c("e24e");const xe=Z()(Ne,[["render",Le]]);var Ie=xe,Ue=c("39c0"),Te=c.n(Ue),Pe=c("49b9"),He=c.n(Pe),Fe={class:"settings-page"},Ve=Object(i["g"])("div",{class:"logo"},[Object(i["g"])("img",{src:ie.a})],-1),Ae={class:"device-detail"},Me={class:"item-detail"},_e={class:"item-detail"},qe=Object(i["g"])("div",{class:"device-control"},[Object(i["g"])("div",{class:"item-control"},[Object(i["g"])("div",{class:"circle"},[Object(i["g"])("img",{src:Te.a})]),Object(i["g"])("div",{class:"description"},[Object(i["i"])("проверить обновление"),Object(i["g"])("br"),Object(i["i"])("прошивки "),Object(i["g"])("span",{class:"bold"},"plonq")])]),Object(i["g"])("div",{class:"item-control"},[Object(i["g"])("div",{class:"circle"},[Object(i["g"])("img",{src:He.a})]),Object(i["g"])("div",{class:"description"},[Object(i["i"])("подключить другой"),Object(i["g"])("br"),Object(i["g"])("span",{class:"bold"},"plonq")])])],-1);function Ee(e,t,c,n,s,a){return Object(i["v"])(),Object(i["f"])("div",null,[Object(i["g"])("div",Fe,[Ve,Object(i["g"])("div",Ae,[Object(i["g"])("div",Me,"Устройство "+Object(i["C"])((e.deviceDetail.deviceName+" "+e.deviceDetail.deviceModel).toUpperCase()),1),Object(i["g"])("div",_e,"Версия прошивки "+Object(i["C"])(e.deviceDetail.firmware),1)]),qe])])}var Re=Object(i["k"])({name:"Settings",setup:function(){var e=Object(Q["b"])(),t=Object(i["b"])((function(){return e.state.deviceDetail}));return{deviceDetail:t}}});c("23b6");const We=Z()(Re,[["render",Ee]]);var Be=We,$e={class:"settings-page"},ze=Object(i["g"])("div",{class:"section-title"},"Р222аздел тестирования",-1),Ge={class:"params"},Je={class:"item-param"},Qe={class:"item-param"},Ye={class:"item-param"},Ke={class:"item-param"},Xe={class:"item-param"},Ze={class:"item-param"},et={class:"item-param"};function tt(e,t,c,n,s,a){return Object(i["v"])(),Object(i["f"])("div",null,[Object(i["g"])("div",$e,[ze,Object(i["g"])("div",Ge,[Object(i["g"])("div",Je,"Статус устройства: "+Object(i["C"])(e.plonq.deviceConnect?"Подключено":"Не подключено"),1),Object(i["g"])("div",Qe,"Версия прошивки: "+Object(i["C"])(e.deviceFirmware),1),Object(i["g"])("div",Ye,"MAC адрес: "+Object(i["C"])(e.deviceMac),1),Object(i["g"])("div",Ke,"Статус зарядки: "+Object(i["C"])(e.deviceCharge?"Заряжается":"Не заряжается"),1),Object(i["g"])("div",Xe,"Кол-во затяжек: "+Object(i["C"])(e.devicePuff),1),Object(i["g"])("div",Ze,"Батарея: "+Object(i["C"])(e.deviceBattery)+"%",1),Object(i["g"])("div",et,"Картридж: "+Object(i["C"])(e.deviceCartridge),1)]),Object(i["g"])("div",{class:"btn-click",onClick:t[0]||(t[0]=function(t){return e.setCommand(85)})},"Запуск режима DFU (0x55)"),Object(i["g"])("div",{class:"btn-click",onClick:t[1]||(t[1]=function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];return e.startDeviceConnect&&e.startDeviceConnect.apply(e,t)})},"Подключиться к устройству"),Object(i["g"])("div",{class:"btn-click",onClick:t[2]||(t[2]=function(t){return e.setCommand(208)})},"Затяжки каждые 30 сек (0xD0)")])])}var ct=Object(i["k"])({name:"System",setup:function(){var e=this,t=Object(Q["b"])(),c=Object(i["b"])((function(){return t.state.deviceConnect})),n=Object(i["b"])((function(){return t.state.deviceDetail.firmware})),s=Object(i["b"])((function(){return t.state.deviceDetail.mac})),a=Object(i["b"])((function(){return t.state.deviceDetail.puffCounter})),r=Object(i["b"])((function(){return t.state.deviceDetail.batteryLevel})),o=Object(i["b"])((function(){return t.state.deviceDetail.cartridge})),l=Object(i["b"])((function(){return t.state.deviceDetail.chargeStatus})),u=Object(i["b"])((function(){return t.state.plonq})),d=Object(i["b"])((function(){return t.state.terminal.reverse()})),v=function(){return Object(J["a"])(e,void 0,void 0,(function(){return Object(J["b"])(this,(function(e){switch(e.label){case 0:return[4,t.dispatch("connectPlonq")];case 1:return e.sent(),[2]}}))}))},b=function(e){switch(e){case 85:u.value.startCommand(e),t.state.terminal.push("Отправляем команду 0x55");break;case 208:u.value.startCommand(e),t.state.terminal.push("Отправляем команду 0xD0");break}};return{plonq:u,terminalList:d,setCommand:b,deviceConnect:c,startDeviceConnect:v,deviceFirmware:n,deviceMac:s,devicePuff:a,deviceBattery:r,deviceCartridge:o,deviceCharge:l}}});c("7940");const it=Z()(ct,[["render",tt]]);var nt=it,st=c("05f9"),at=c.n(st),rt=c("abe1"),ot=c.n(rt);const lt={class:"firmware-update-info-setup"},ut=Object(i["g"])("div",{class:"title"},[Object(i["i"])("Подготовка к"),Object(i["g"])("br"),Object(i["i"])("установке...")],-1),dt={class:"content"},vt=Object(i["g"])("div",{class:"label"},"Пожалуйста, убедитесь, что:",-1),bt={class:"setup-group"},ft={class:"item-setup"},gt=Object(i["g"])("div",{class:"description"},[Object(i["i"])("УСТРОЙСТВО И ТЕЛЕФОН Соединены ПО "),Object(i["g"])("span",{class:"bold"},"BLUETOOTH")],-1),ht={class:"item-setup"},pt=Object(i["g"])("div",{class:"description"},[Object(i["i"])("УСТРОЙСТВО ПОСТАВЛЕНО НА "),Object(i["g"])("span",{class:"bold"},"ЗАРЯДКУ"),Object(i["i"])(" И ЗАРЯЖАЕТСЯ")],-1),Ot={class:"btn-group"},jt=Object(i["g"])("span",null,"Продолжить",-1),mt=[jt],yt={key:0,class:"start-firmware-update"},wt=Object(i["g"])("div",{class:"logo"},[Object(i["g"])("img",{src:ie.a})],-1),Ct=Object(i["g"])("div",{class:"description flashlight"},"Устанавливаем обновление",-1),Dt={class:"progress-bar"},St={class:"percent"},kt={key:0,class:"firmware-done"},Lt=Object(i["g"])("div",{class:"icon-device"},[Object(i["g"])("img",{src:at.a})],-1),Nt=Object(i["g"])("div",{class:"description"},"У вас установленна актуальная версия прошивки",-1),xt={key:0,class:"firmware-error"},It=Object(i["g"])("div",{class:"icon-device"},[Object(i["g"])("img",{src:ot.a})],-1),Ut=Object(i["g"])("div",{class:"description"},"Ошибка при обновлении, повторите попытку позже",-1),Tt={class:"confirm"},Pt=Object(i["h"])('<div class="title">Последние проверки</div><div class="description"><span class="bold">Перед началом установки</span> - убедитесь что индикатор на устройстве загорелся <span class="bold">синим</span> цветом</div><div class="indicator"></div>',3),Ht=Object(i["g"])("div",{class:"bg-filter"},null,-1);function Ft(e,t,c,n,s,a){return Object(i["v"])(),Object(i["f"])("div",null,[Object(i["g"])("div",lt,[ut,Object(i["g"])("div",dt,[vt,Object(i["g"])("div",bt,[Object(i["g"])("div",ft,[Object(i["g"])("div",{class:Object(i["p"])(["circle",e.deviceConnect?"active":""])},"1",2),gt]),Object(i["g"])("div",ht,[Object(i["g"])("div",{class:Object(i["p"])(["circle",e.chargeStatus?"active":""])},"2",2),pt])])]),Object(i["g"])("div",Ot,[Object(i["g"])("a",{href:"#",class:Object(i["p"])(["btn-sync",e.deviceConnect&&e.chargeStatus?"active":""]),onClick:t[0]||(t[0]=(...t)=>e.nextStepSetup&&e.nextStepSetup(...t))},mt,2),Object(i["g"])("a",{href:"#",class:"btn-cancel",onClick:t[1]||(t[1]=t=>e.router.push({name:"Main"}))},"Отменить")])]),Object(i["j"])(i["a"],{name:"slide-fade",mode:"out-in"},{default:Object(i["F"])(()=>[e.statusProcessUpdate?(Object(i["v"])(),Object(i["f"])("div",yt,[wt,Ct,Object(i["g"])("div",Dt,[Object(i["g"])("div",{class:"progress",style:Object(i["q"])(`width: ${e.processUpdatePercent}%;`)},null,4)]),Object(i["g"])("div",St,Object(i["C"])(e.processUpdatePercent)+"%",1)])):Object(i["e"])("",!0)]),_:1}),Object(i["j"])(i["a"],{name:"slide-fade",mode:"out-in"},{default:Object(i["F"])(()=>[e.statusProcessDone?(Object(i["v"])(),Object(i["f"])("div",kt,[Lt,Nt,Object(i["g"])("a",{href:"#",class:"btn-cancel",onClick:t[2]||(t[2]=(...t)=>e.statusProcessFinish&&e.statusProcessFinish(...t))},"Закрыть")])):Object(i["e"])("",!0)]),_:1}),Object(i["j"])(i["a"],{name:"slide-fade",mode:"out-in"},{default:Object(i["F"])(()=>[e.statusProcessError?(Object(i["v"])(),Object(i["f"])("div",xt,[It,Ut,Object(i["g"])("a",{href:"#",class:"btn-cancel",onClick:t[3]||(t[3]=(...t)=>e.statusProcessErrorClose&&e.statusProcessErrorClose(...t))},"Закрыть")])):Object(i["e"])("",!0)]),_:1}),Object(i["g"])("div",{class:Object(i["p"])(["slideup",1==e.statusSlideupConfirm?"activate":"deactivate"])},[Object(i["g"])("div",Tt,[Pt,Object(i["g"])("div",{href:"#",class:Object(i["p"])(["btn-confirm",e.messageTimerToActive?"active":""]),onClick:t[4]||(t[4]=t=>{e.clickDFU(t)})},"Выбрать устройство",2)]),Ht],2)])}var Vt=c("7837"),At=c.n(Vt),Mt=c("702d"),_t=c.n(Mt),qt=c("6749"),Et=c.n(qt),Rt=null,Wt=function(e){Rt=e},Bt=Object(i["k"])({name:"FirmwareUpdate",setup(){const e=Object(Q["b"])(),t=Object(Y["c"])(),c=Object(i["b"])(()=>e.state.deviceConnect),n=Object(i["b"])(()=>e.state.deviceDetail.chargeStatus),s=Object(i["y"])(!1),a=Object(i["y"])(!1),r=Object(i["y"])(!1),o=()=>{r.value=!1},l=Object(i["y"])(0),u=()=>{t.push({name:"Main"}),e.state.deviceConnect=!1},d=new At.a(_t.a.buf);d.SERVICE_UUID="FE59";const v=Object(i["b"])(()=>e.state.plonq),b=e=>{e.target.closest(".slideup").style.display="block",setTimeout(()=>{e.target.closest(".slideup").style.display="none"},600)},f=Object(i["y"])(!1),g=async()=>{c.value?(console.log("start uuuupdate"),await Rt.startCommand(85),f.value=!0):alert("Выполните все шаги до начала установки")},h=()=>{};async function p(e){let t=await fetch(e),c=await t.blob(),i={type:"application/zip"},n=new File([c],"firmware.zip",i);return n}const O=e=>{if(!e)return void console.log("setTransfer empty");e.currentBytes,e.totalBytes,e.object;let t=parseInt(e.currentBytes/e.totalBytes*100);return l.value=t,t},j=async()=>{let t=await p(e.state.firmwareData.file);if(!t)return void console.log("Нет файла для установки");let c=new Et.a(t);return await c.load(),c},m=async(t,c,i)=>{i?Promise.resolve().then(()=>(console.log("getBaseImage"),i.getBaseImage())).then(e=>{if(e)return console.log(`Updating ${e.type}: ${e.imageFile}...`),t.update(c,e.initData,e.imageData)}).then(()=>i.getAppImage()).then(e=>{if(e)return console.log(`Updating ${e.type}: ${e.imageFile}...`),t.update(c,e.initData,e.imageData)}).then(async()=>{console.log("Update complete!"),a.value=!0,e.state.statusUpdateNow=!1,O(0),setTimeout(async()=>{try{let t=await v.value.connect();if(t["connected"]){e.commit("setDeviceConnect",!0),e.commit("setDeviceDetail",await v.deviceDetail),await e.dispatch("startGattNotify",v);let t=`${e.state.deviceDetail.deviceName} ${e.state.deviceDetail.deviceModel}`.toUpperCase();context.dispatch("startNotifyTooltip",{message:t+" подключён",icon:"device"}),clearInterval(connectInterval)}else e.commit("setDeviceConnect",!0),e.commit("setSlideupConnectDevice",!0)}catch(t){console.log("Ошибка подключения к устройству TRY"),console.log(t)}},1500)}).catch(t=>{s.value=!1,a.value=!1,r.value=!0,console.log("Ошибка обновления прошивки"),console.log(t),e.state.statusUpdateNow=!1}):console.log("Pack не существует..")};d.addEventListener("log",e=>{}),d.addEventListener("progress",e=>{O(e)});const y=async e=>{let t=await d.requestDevice(!1,[{name:"DfuTarg"},{namePrefix:"DfuTarg"}]);t?(b(e),setTimeout(()=>{s.value=!0},600)):setTimeout(()=>{b(e)},600),console.log("Device.."),console.log(t),console.log("set Dfu Mode..."),console.log("Set package...");let c=await j();console.log("Start update..."),m(d,t,c)};return{deviceConnect:c,chargeStatus:n,clickDFU:y,statusProcessUpdate:s,processUpdatePercent:l,statusProcessDone:a,statusProcessError:r,statusProcessFinish:u,statusProcessErrorClose:o,messageTimerToActive:h,nextStepSetup:g,statusSlideupConfirm:f}}});c("ca8a");const $t=Z()(Bt,[["render",Ft]]);var zt=$t,Gt={class:"main-page"},Jt={class:"header"},Qt=Object(i["g"])("div",{class:"info"},[Object(i["g"])("div",{class:"logo"},[Object(i["g"])("img",{src:ie.a})]),Object(i["g"])("div",{class:"stats"},[Object(i["g"])("div",{class:"item"},[Object(i["g"])("div",{class:"icon"},[Object(i["g"])("img",{src:r.a})]),Object(i["g"])("div",{class:"text"},"подключено")]),Object(i["g"])("div",{class:"item"},[Object(i["g"])("div",{class:"icon"},[Object(i["g"])("img",{src:l.a})]),Object(i["g"])("div",{class:"text"},"72%")]),Object(i["g"])("div",{class:"item"},[Object(i["g"])("div",{class:"icon"},[Object(i["g"])("img",{src:d.a})]),Object(i["g"])("div",{class:"text"},"манго")])])],-1),Yt={class:"device"},Kt=Object(i["g"])("div",{class:"device-bg"},null,-1),Xt=Object(i["h"])('<div class="main-content"><div class="today">Сегодня <span class="bold">23 июня</span></div><div class="counter-group"><div class="item-counter active"><div class="count count-today">0</div><div class="label">Затяжек</div></div><div class="item-counter"><div class="count count-week">128</div><div class="label">Среднее за тоже время<br>(последние 7 дней)</div></div></div></div>',1);function Zt(e,t,n,s,a,r){return Object(i["v"])(),Object(i["f"])("div",Gt,[Object(i["g"])("div",Jt,[Qt,Object(i["g"])("div",Yt,[Object(i["g"])("div",{class:"device-image",style:Object(i["q"])("background-image: url('"+c("f92f")+"')")},null,4),Kt])]),Xt])}var ec=Object(i["k"])({name:"Stats"});const tc=Z()(ec,[["render",Zt]]);var cc=tc,ic=c("1780"),nc=c.n(ic),sc=c("2de5"),ac=c.n(sc),rc=c("4eca"),oc=c.n(rc),lc={class:"onboarding-slide"},uc=Object(i["g"])("div",{class:"logo"},[Object(i["g"])("img",{src:ie.a})],-1),dc=Object(i["g"])("div",{class:"title"},[Object(i["i"])("123Управляйте курением"),Object(i["g"])("br"),Object(i["i"])("вместе c "),Object(i["g"])("span",{class:"bold"},"PLONQ")],-1),vc=Object(i["g"])("div",{class:"app-image"},[Object(i["g"])("img",{src:nc.a})],-1),bc=Object(i["g"])("div",{class:"title"},[Object(i["i"])("Следите за"),Object(i["g"])("br"),Object(i["i"])("статистикой курения")],-1),fc=Object(i["g"])("div",{class:"app-image"},[Object(i["g"])("img",{src:ac.a})],-1),gc=Object(i["g"])("div",{class:"title"},[Object(i["i"])("123Плавно снижайте"),Object(i["g"])("br"),Object(i["i"])("интенсивность")],-1),hc=Object(i["g"])("div",{class:"app-image"},[Object(i["g"])("img",{src:oc.a})],-1);function pc(e,t,c,n,s,a){return Object(i["v"])(),Object(i["f"])("div",null,[Object(i["g"])("div",lc,[uc,Object(i["g"])("div",{class:"onboarding-page",style:Object(i["q"])("left: "+e.slideLeftNumber[0]+"px")},[dc,vc,Object(i["g"])("a",{href:"javascript://",class:"next-slide",onClick:t[0]||(t[0]=function(t){return e.nextSlide(2)})},"Далее")],4),Object(i["g"])("div",{class:"onboarding-page",style:Object(i["q"])("left: "+e.slideLeftNumber[1]+"px")},[bc,fc,Object(i["g"])("a",{hef:"javascript://",class:"next-slide",onClick:t[1]||(t[1]=function(t){return e.nextSlide(3)})},"Далее")],4),Object(i["g"])("div",{class:"onboarding-page",style:Object(i["q"])("left: "+e.slideLeftNumber[2]+"px")},[gc,hc,Object(i["g"])("a",{hef:"javascript://",class:"next-slide",onClick:t[2]||(t[2]=function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];return e.confirmAge&&e.confirmAge.apply(e,t)})},"всё ясно")],4)])])}var Oc=Object(i["k"])({name:"onboard",setup:function(){var e=this,t=Object(Q["b"])(),c=Object(i["y"])([0,window.innerWidth,2*window.innerWidth]),n=function(){t.state.slideupConfirmAge=!0,t.state.onboard=!0},s=function(t){return Object(J["a"])(e,void 0,void 0,(function(){return Object(J["b"])(this,(function(e){switch(t){case 1:c.value=[0,window.innerWidth,2*window.innerWidth];break;case 2:c.value=[window.innerWidth-2*window.innerWidth,0,window.innerWidth];break;case 3:c.value=[window.innerWidth-2*window.innerWidth*2,window.innerWidth-2*window.innerWidth,0];break;default:}return[2]}))}))};return{slideLeftNumber:c,nextSlide:s,confirmAge:n}}});const jc=Z()(Oc,[["render",pc]]);var mc=jc,yc={class:"sync-page"},wc=Object(i["g"])("div",{class:"sync-preview"},[Object(i["g"])("div",{class:"preview-bg"})],-1),Cc={class:"content"},Dc={key:0,class:"sync-description"},Sc=Object(i["i"])(" Поднесите "),kc=Object(i["g"])("span",{class:"bold"},"PLONQ",-1),Lc=Object(i["i"])(" к телефону и нажмите "),Nc=Object(i["g"])("span",{class:"bold"},"Подключить",-1),xc=[Sc,kc,Lc,Nc],Ic={key:1,class:"sync-description"},Uc=Object(i["i"])(" Пожалуйста, "),Tc=Object(i["g"])("span",{class:"bold"},"достаньте",-1),Pc=Object(i["i"])(" и "),Hc=Object(i["g"])("span",{class:"bold"},"вставьте",-1),Fc=Object(i["g"])("br",null,null,-1),Vc=Object(i["i"])("картридж в устройство "),Ac=[Uc,Tc,Pc,Hc,Fc,Vc],Mc=Object(i["g"])("div",{class:"icon-sync"},[Object(i["g"])("div",{class:"sync-bg"})],-1),_c=Object(i["g"])("a",{href:"#",class:"btn-cancel"},"Отменить",-1);function qc(e,t,c,n,s,a){return Object(i["v"])(),Object(i["f"])("div",null,[Object(i["g"])("div",yc,[wc,Object(i["g"])("div",Cc,[1==e.activeStep?(Object(i["v"])(),Object(i["f"])("div",Dc,xc)):Object(i["e"])("",!0),2==e.activeStep?(Object(i["v"])(),Object(i["f"])("div",Ic,Ac)):Object(i["e"])("",!0),Object(i["g"])("a",{href:"#",class:Object(i["p"])(["btn-sync",e.connectDeviceInProcess?"syncing":""]),onClick:t[0]||(t[0]=function(t){return e.startFindDevice()})},[Mc,Object(i["g"])("span",null,Object(i["C"])(1==e.deviceConnect?"Подключено":"Подключить"),1)],2),_c])])])}var Ec=Object(i["k"])({name:"sync",setup:function(){var e=this,t=Object(Q["b"])(),c=Object(Y["c"])(),n=Object(i["y"])(1),s=Object(i["b"])((function(){return t.state.connectDeviceInProcess})),a=Object(i["b"])((function(){return t.state.deviceConnect})),r=function(){return Object(J["a"])(e,void 0,void 0,(function(){return Object(J["b"])(this,(function(e){switch(e.label){case 0:return[4,t.dispatch("connectPlonq")];case 1:return e.sent(),c.push({name:"Main"}),[2]}}))}))};return{activeStep:n,startFindDevice:r,connectDeviceInProcess:s,deviceConnect:a}}});const Rc=Z()(Ec,[["render",qc]]);var Wc=Rc,Bc=[{path:"/",name:"Main",component:Ie},{path:"/stats",name:"Stats",component:cc},{path:"/settings",name:"Settings",component:Be},{path:"/system",name:"System",component:nt},{path:"/firmware-update",name:"FirmwareUpdate",component:zt},{path:"/onboard",name:"Onboard",component:mc},{path:"/sync",name:"Sync",component:Wc}],$c=Object(Y["a"])({history:Object(Y["b"])("/"),routes:Bc}),zc=$c,Gc=function(){function e(){this.deviceDetail={firmware:null,firmwareVersion:null,hardware:null,deviceName:null,deviceModel:null,batteryLevel:0,chargeStatus:!1,puffCounter:0,unixtime:0,mac:null,cartridge:0,tx:null},this.servicesList={deviceInfo:"device_information",deviceInfoUUID:"0000180a-0000-1000-8000-00805f9b34fb",deviceInfoIOS:6154,battery:"0000180f-0000-1000-8000-00805f9b34fb",batteryIOS:6159,service:"00005523-1212-efde-1523-785feabcd133",nordic:"6e400001-b5a3-f393-e0a9-e50e24dcca9e"},this.charsList={firmware:"00002a26-0000-1000-8000-00805f9b34fb",firmwareIOS:10790,firmwareVersion:"00001560-1212-efde-1523-785feabcd133",hardware:"00002a27-0000-1000-8000-00805f9b34fb",hardwareIOS:10791,deviceName:"00002a29-0000-1000-8000-00805f9b34fb",deviceNameIOS:10793,deviceModel:"00002a24-0000-1000-8000-00805f9b34fb",deviceModelIOS:10788,batteryLevel:"00002a19-0000-1000-8000-00805f9b34fb",batteryLevelIOS:10777,charge:"00001540-1212-efde-1523-785feabcd133",puffCounter:"00001235-1212-efde-1523-785feabcd133",unixtime:"00001526-1212-efde-1523-785feabcd133",mac:"00001570-1212-efde-1523-785feabcd133",cartridge:"00001580-1212-efde-1523-785feabcd133",rx:"6e400002-b5a3-f393-e0a9-e50e24dcca9e",tx:"6e400003-b5a3-f393-e0a9-e50e24dcca9e",nordicWrite:"6e400042-b5a3-f393-e0a9-e50e24dcca9e",nordicRead:"6e400043-b5a3-f393-e0a9-e50e24dcca9e"},this.servicesHandle={deviceInfo:null,battery:null,service:null,nordic:null},this.charsHandle={deviceInfo:{firmware:null,hardware:null,deviceName:null,deviceModel:null},battery:{batteryLevel:null,batteryLevelNotify:null},service:{charge:null,chargeNotify:null,puffCounter:null,puffCounterNotify:null,unixtime:null,unixtimeNotify:null,firmwareVersion:null,mac:null,cartridge:null,cartridgeNotify:null},nordic:{rx:null,tx:null,txNotify:null,nordicWrite:null,nordicRead:null}},this.tsNavigator=navigator}return e.prototype.request=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t,c;return Object(J["b"])(this,(function(i){switch(i.label){case 0:if(e={filters:[{name:"DfuTarg"},{name:"PLONQ"},{namePrefix:"DfuTarg"},{namePrefix:"PLONQ"}],optionalServices:[this.servicesList.deviceInfo,this.servicesList.battery,this.servicesList.service,this.servicesList.nordic,6154,6159]},void 0==this.tsNavigator.bluetooth)return alert("Данное приложение не поддерживает необходимые для работы технологии"),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),t=this,[4,this.tsNavigator.bluetooth.requestDevice(e)];case 2:return t.device=i.sent(),console.log("got device"),console.log(this.device),[3,4];case 3:return c=i.sent(),console.log("error requestDevice"),console.log(c),[3,4];case 4:if(!this.device)throw"Устройство не выбрано";return[2]}}))}))},e.prototype.getServices=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t,c,i;return Object(J["b"])(this,(function(n){switch(n.label){case 0:if(!this.device)throw"Устройство не выбрано";return console.log("----------------- getServices ------"),e=this,[4,this.server.getPrimaryServices()];case 1:for(e.services=n.sent(),t=0,c=this.services;t<c.length;t++)switch(i=c[t],console.log("Service: "+i.uuid),i.uuid){case this.servicesList.deviceInfoUUID:this.servicesHandle.deviceInfo=i;break;case this.servicesList.deviceInfoIOS:this.servicesHandle.deviceInfo=i;break;case this.servicesList.battery:console.log("battery found"),console.log(i),console.log("----------------------"),console.log(JSON.stringify(this.servicesHandle)),this.servicesHandle.battery=i;break;case this.servicesList.batteryIOS:this.servicesHandle.battery=i;break;case this.servicesList.service:this.servicesHandle.service=i;break;case this.servicesList.nordic:this.servicesHandle.nordic=i,console.log("nordic found"),console.log(i),console.log("----------------------"),console.log(JSON.stringify(this.servicesHandle)),console.log("----------------------"),console.log(this.servicesHandle.nordic),console.log("----------------------");break;default:console.log("Неизвестный сервис "+i.uuid);break}return console.log(this.servicesHandle),console.log(JSON.stringify(this.servicesHandle)),[2]}}))}))},e.prototype.getChars=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t,c,i,n,s,a,r,o,l,u,d,v,b,f,g,h,p,O,j,m,y,w,C,D,S,k,L,N,x,I,U,T,P,H,F,V,A,M,_,q;return Object(J["b"])(this,(function(E){switch(E.label){case 0:e=new TextDecoder("utf-8"),t=[this.servicesHandle.deviceInfo,this.servicesHandle.battery,this.servicesHandle.service,this.servicesHandle.nordic],c=0,i=t,E.label=1;case 1:if(!(c<i.length))return[3,71];switch(n=i[c],s=n.uuid,s){case this.servicesHandle.deviceInfo.uuid:return[3,2];case this.servicesHandle.battery.uuid:return[3,26];case this.servicesHandle.service.uuid:return[3,38];case this.servicesHandle.nordic.uuid:return[3,58]}return[3,70];case 2:return E.trys.push([2,24,,25]),[4,n.getCharacteristics()];case 3:H=E.sent(),a=0,r=H,E.label=4;case 4:if(!(a<r.length))return[3,23];switch(A=r[a],o=A.uuid,o){case this.charsList.firmware:return[3,5];case this.charsList.hardware:return[3,7];case this.charsList.deviceName:return[3,9];case this.charsList.deviceModel:return[3,11];case this.charsList.firmwareIOS:return[3,13];case this.charsList.hardwareIOS:return[3,15];case this.charsList.deviceNameIOS:return[3,17];case this.charsList.deviceModelIOS:return[3,19]}return[3,21];case 5:return this.charsHandle.deviceInfo.firmware=A,l=this.deviceDetail,[4,A.readValue().then((function(t){return e.decode(t)}))];case 6:return l.firmware=E.sent(),console.log("Версия прошивки: "+this.deviceDetail.firmware),[3,22];case 7:return this.charsHandle.deviceInfo.hardware=A,u=this.deviceDetail,[4,A.readValue().then((function(t){return e.decode(t)}))];case 8:return u.hardware=E.sent(),console.log("Версия устройства: "+this.deviceDetail.hardware),[3,22];case 9:return this.charsHandle.deviceInfo.deviceName=A,d=this.deviceDetail,[4,A.readValue().then((function(t){return e.decode(t)}))];case 10:return d.deviceName=E.sent(),console.log("Имя устройства: "+this.deviceDetail.deviceName),[3,22];case 11:return this.charsHandle.deviceInfo.deviceModel=A,v=this.deviceDetail,[4,A.readValue().then((function(t){return e.decode(t)}))];case 12:return v.deviceModel=E.sent(),console.log("Модель устройства: "+this.deviceDetail.deviceModel),[3,22];case 13:return this.charsHandle.deviceInfo.firmware=A,b=this.deviceDetail,[4,A.readValue().then((function(t){return e.decode(t)}))];case 14:return b.firmware=E.sent(),console.log("Версия прошивки IOS: "+this.deviceDetail.firmware),[3,22];case 15:return this.charsHandle.deviceInfo.hardware=A,f=this.deviceDetail,[4,A.readValue().then((function(t){return e.decode(t)}))];case 16:return f.hardware=E.sent(),console.log("Версия устройства IOS: "+this.deviceDetail.hardware),[3,22];case 17:return this.charsHandle.deviceInfo.deviceName=A,g=this.deviceDetail,[4,A.readValue().then((function(t){return e.decode(t)}))];case 18:return g.deviceName=E.sent(),console.log("Имя устройства IOS: "+this.deviceDetail.deviceName),[3,22];case 19:return this.charsHandle.deviceInfo.deviceModel=A,h=this.deviceDetail,[4,A.readValue().then((function(t){return e.decode(t)}))];case 20:return h.deviceModel=E.sent(),console.log("Модель устройства IOS: "+this.deviceDetail.deviceModel),[3,22];case 21:return console.log("Неизвестная характеристика "+A.uuid),[3,22];case 22:return a++,[3,4];case 23:return[3,25];case 24:return p=E.sent(),console.log("Ошибка при получении списка характеристик"),console.log(p),[3,25];case 25:return[3,70];case 26:return E.trys.push([26,36,,37]),[4,n.getCharacteristics()];case 27:H=E.sent(),O=0,j=H,E.label=28;case 28:if(!(O<j.length))return[3,35];switch(A=j[O],m=A.uuid,m){case this.charsList.batteryLevel:return[3,29];case this.charsList.batteryLevelIOS:return[3,31]}return[3,33];case 29:return this.charsHandle.battery.batteryLevel=A,y=this.deviceDetail,[4,A.readValue().then((function(e){return e.getUint8()}))];case 30:return y.batteryLevel=E.sent(),console.log("Заряд батареи: "+this.deviceDetail.batteryLevel+"%"),[3,34];case 31:return this.charsHandle.battery.batteryLevel=A,w=this.deviceDetail,[4,A.readValue().then((function(e){return e.getUint8()}))];case 32:return w.batteryLevel=E.sent(),console.log("Заряд батареи IOS: "+this.deviceDetail.batteryLevel+"%"),[3,34];case 33:return console.log("Неизвестная характеристика "+A.uuid),[3,34];case 34:return O++,[3,28];case 35:return[3,37];case 36:return C=E.sent(),console.log("Ошибка при получении списка характеристик"),console.log(C),[3,37];case 37:return[3,70];case 38:return E.trys.push([38,56,,57]),[4,n.getCharacteristics()];case 39:H=E.sent(),D=0,S=H,E.label=40;case 40:if(!(D<S.length))return[3,55];switch(A=S[D],k=A.uuid,k){case this.charsList.charge:return[3,41];case this.charsList.puffCounter:return[3,43];case this.charsList.unixtime:return[3,45];case this.charsList.firmwareVersion:return[3,47];case this.charsList.mac:return[3,49];case this.charsList.cartridge:return[3,51]}return[3,53];case 41:return this.charsHandle.service.charge=A,L=this.deviceDetail,[4,A.readValue().then((function(e){return e.getUint8()}))];case 42:return L.charge=E.sent(),console.log("Статус зарядки: "+this.deviceDetail.charge),[3,54];case 43:return this.charsHandle.service.puffCounter=A,N=this.deviceDetail,[4,A.readValue().then((function(e){return e.getUint8()}))];case 44:return N.puffCounter=E.sent(),console.log("Количество затяжек: "+this.deviceDetail.puffCounter),[3,54];case 45:return this.charsHandle.service.unixtime=A,x=this.deviceDetail,[4,A.readValue().then((function(e){return e.getUint32()}))];case 46:return x.unixtime=E.sent(),console.log("Время на устройстве: "+this.deviceDetail.unixtime),[3,54];case 47:return this.charsHandle.service.firmwareVersion=A,I=this.deviceDetail,[4,A.readValue().then((function(e){return e.getUint8()}))];case 48:return I.firmwareVersion=E.sent(),console.log("Версия прошивки Legacy: "+this.deviceDetail.firmwareVersion),[3,54];case 49:return this.charsHandle.service.mac=A,U=this.deviceDetail,[4,A.readValue().then((function(e){var t=new Uint8Array(e.buffer).map((function(e){return parseInt(e,10)})),c=[];for(var i in t){var n=Number(t[i]).toString(16);n.length<2&&(n+="0",n=n.split("").reverse().join("")),c.push(n)}return c.join(":").toUpperCase()}))];case 50:return U.mac=E.sent(),console.log("MAC: "+this.deviceDetail.mac),[3,54];case 51:return this.charsHandle.service.cartridge=A,T=this.deviceDetail,[4,A.readValue().then((function(e){return e.getUint8()}))];case 52:return T.cartridge=E.sent(),console.log("Cartridge: "+this.deviceDetail.cartridge),[3,54];case 53:return console.log("Неизвестная характеристика "+A.uuid),[3,54];case 54:return D++,[3,40];case 55:return[3,57];case 56:return P=E.sent(),console.log("Ошибка при получении списка характеристик"),console.log(P),[3,57];case 57:return[3,70];case 58:return E.trys.push([58,68,,69]),[4,n.getCharacteristics()];case 59:H=E.sent(),F=0,V=H,E.label=60;case 60:if(!(F<V.length))return[3,67];switch(A=V[F],M=A.uuid,M){case this.charsList.nordicWrite:return[3,61];case this.charsList.nordicRead:return[3,62];case this.charsList.tx:return[3,63]}return[3,65];case 61:return this.charsHandle.nordic.nordicWrite=A,[3,66];case 62:return this.charsHandle.nordic.nordicRead=A,[3,66];case 63:return this.charsHandle.nordic.tx=A,_=this.deviceDetail,[4,A.readValue().then((function(e){return e.getUint8()}))];case 64:return _.tx=E.sent(),[3,66];case 65:return console.log("Неизвестная характеристика "+A.uuid),[3,66];case 66:return F++,[3,60];case 67:return[3,69];case 68:return q=E.sent(),console.log("Ошибка при получении списка характеристик"),console.log(q),[3,69];case 69:return[3,70];case 70:return c++,[3,1];case 71:return[2]}}))}))},e.prototype.startCommand=function(e){return Object(J["a"])(this,void 0,void 0,(function(){var t,c;return Object(J["b"])(this,(function(i){switch(i.label){case 0:if(!this.device)return console.log("Устройство не подключено"),[2,!1];i.label=1;case 1:return i.trys.push([1,3,,4]),console.log("go go"),[4,this.charsHandle.nordic.nordicWrite.writeValue(new Uint8Array([e]))];case 2:return t=i.sent(),console.log("# ~ Пишет "+e+" в NORDIC"),console.log(t),[3,4];case 3:return c=i.sent(),console.log(c),[3,4];case 4:return[2]}}))}))},e.prototype.testNordic=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t,c,i,n,s;return Object(J["b"])(this,(function(a){switch(a.label){case 0:return a.trys.push([0,7,,8]),console.log("------- NORDIC -----------"),this.logServer(),[4,this.server.getPrimaryService("6e400001-b5a3-f393-e0a9-e50e24dcca9e")];case 1:return e=a.sent(),console.log(e),[4,e.getCharacteristics()];case 2:t=a.sent(),console.log("got charslist"),c=0,i=t,a.label=3;case 3:return c<i.length?(n=i[c],console.log(n.uuid),"6e400042-b5a3-f393-e0a9-e50e24dcca9e"!==n.uuid?[3,5]:[4,n.writeValue(new Uint8Array([85]))]):[3,6];case 4:return a.sent(),[3,6];case 5:return c++,[3,3];case 6:return console.log("--------- END ------------"),[3,8];case 7:return s=a.sent(),console.log(s),console.log(s.stack),[3,8];case 8:return[2]}}))}))},e.prototype.connect=function(){return Object(J["a"])(this,void 0,void 0,(function(){var e,t;return Object(J["b"])(this,(function(c){switch(c.label){case 0:if(!this.device)return[2,Promise.reject("Устройство не подключено")];c.label=1;case 1:return c.trys.push([1,5,,6]),e=this,[4,this.device.gatt.connect()];case 2:return e.server=c.sent(),console.log("Подключились к серверу GATT"),this.logServer(),[4,this.getServices()];case 3:return c.sent(),this.logServer(),[4,this.getChars()];case 4:return c.sent(),this.logServer(),console.log("Устройство подключено"),[2,{connected:!0}];case 5:return t=c.sent(),console.log(t),[2,{connected:!1}];case 6:return[2]}}))}))},e.prototype.logServer=function(){console.log("++++++++++++++++++++++  SERVER INFO"),console.log(this.server),console.log(this.server.device),console.log("++++++++++++++++++++++")},e.prototype.disconnect=function(){return this.device?(this.device.gatt.disconnect(),{connected:!1}):Promise.reject("Отключаем устройство")},e}(),Jc=Gc,Qc=c("bc3a"),Yc=c.n(Qc),Kc=Object(Q["a"])({state:{terminal:new Array,onboard:!1,slideupConfirmAge:!1,slideupSelectDevice:!1,slideupConnectDevice:!1,statusUpdateNow:!1,deviceConnect:!1,deviceDetail:{firmware:"",firmwareVersion:"",hardware:"",deviceName:"",deviceModel:"",batteryLevel:0,chargeStatus:!1,puffCounter:0,unixtime:0,mac:"",cartridge:0,tx:null},notifyTooltip:{status:!1,message:null,icon:null},plonq:{},firmwareToken:null,firmwareData:{version:"",file:"",charges:""},connectDeviceInProcess:!1,alertUpdateStatus:!1},mutations:{setSlideupConnectDevice:function(e,t){e.slideupConnectDevice=t},setAlertUpdateStatus:function(e,t){e.alertUpdateStatus=t},setFirmwareToken:function(e,t){e.firmwareToken=t},setFirmwareData:function(e,t){e.firmwareData=t},setPlonqHandle:function(e,t){e.plonq=t},setStartNotifyTooltip:function(e,t){e.notifyTooltip.status=!0,e.notifyTooltip.message=t.message,e.notifyTooltip.icon=t.icon},setStopNotifyTooltip:function(e){e.notifyTooltip.status=!1},setConnectDeviceInProcess:function(e,t){e.connectDeviceInProcess=t},setDeviceConnect:function(e,t){e.deviceConnect=t},setDeviceDetail:function(e,t){e.deviceDetail=t},setPuffCount:function(e,t){e.deviceDetail.puffCounter=t},setChargeStatus:function(e,t){e.deviceDetail.chargeStatus=t},setBatteryLevel:function(e,t){e.deviceDetail.batteryLevel=t},setCartridge:function(e,t){e.deviceDetail.cartridge=t}},actions:{firmwareServerRegistration:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var e,c,i;return Object(J["b"])(this,(function(n){switch(n.label){case 0:if(!t)return[3,4];e=new FormData,e.append("username",t),e.append("el_cigarette_id","1"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Yc()({url:"https://ponq.ru:8000/rest-auth/registration/",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})];case 2:return c=n.sent().data,Object.keys(c).includes("key")?[2,c]:[3,4];case 3:return i=n.sent(),console.log("Ошибка регистрации"),[2,i];case 4:return[2]}}))}))},firmwareServerLogin:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var e,c,i;return Object(J["b"])(this,(function(n){switch(n.label){case 0:if(!t)return[3,4];e=new FormData,e.append("username",t),e.append("el_cigarette_id","1"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Yc()({url:"https://ponq.ru:8000/rest-auth/login/",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})];case 2:return c=n.sent().data,Object.keys(c).includes("key")?[2,c]:[3,4];case 3:return i=n.sent(),console.log("Ошибка авторизации"),[2,i];case 4:return[2]}}))}))},firmwareServerAutoLogin:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var c,i;return Object(J["b"])(this,(function(n){switch(n.label){case 0:return[4,e.dispatch("firmwareServerRegistration",t)];case 1:return c=n.sent(),Object.keys(c).includes("key")?(e.commit("setFirmwareToken",c.key),console.log("Регистрация: "+c.key),[2,c.key]):[3,2];case 2:return[4,e.dispatch("firmwareServerLogin",t)];case 3:return i=n.sent(),Object.keys(i).includes("key")?(e.commit("setFirmwareToken",i.key),console.log("Авторизация: "+i.key),[2,i.key]):[2,!1]}}))}))},getLastFirmwareVersion:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var c;return Object(J["b"])(this,(function(i){switch(i.label){case 0:return[4,Yc()({url:"https://ponq.ru:8000/user/device/firmware/",method:"get",headers:{Authorization:"Token "+t}})];case 1:return c=i.sent().data,Object.keys(c).includes("version")?(e.commit("setFirmwareData",c),console.log(c),[2,c]):(console.log("Не удалось получить версию прошивки"),[2,c])}}))}))},initDataFirmware:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var c;return Object(J["b"])(this,(function(i){switch(i.label){case 0:return[4,e.dispatch("firmwareServerAutoLogin",t)];case 1:return c=i.sent(),c?[4,e.dispatch("getLastFirmwareVersion",c)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2,!0]}}))}))},startNotifyTooltip:function(e,t){var c=t.message,i=t.icon;return Object(J["a"])(this,void 0,void 0,(function(){return Object(J["b"])(this,(function(t){return e.commit("setStartNotifyTooltip",{message:c,icon:i}),setTimeout((function(){return e.commit("setStopNotifyTooltip")}),2700),[2]}))}))},connectPlonq:function(e){return Object(J["a"])(this,void 0,void 0,(function(){var t,c,i,n,s,a,r,o;return Object(J["b"])(this,(function(l){switch(l.label){case 0:console.log("Запускаем подключение.."),t=new Jc,e.commit("setPlonqHandle",t),l.label=1;case 1:l.trys.push([1,11,,12]),e.commit("setConnectDeviceInProcess",!0),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,t.request()];case 3:return l.sent(),[3,5];case 4:return c=l.sent(),console.log(c),[3,5];case 5:return[4,t.connect()];case 6:return i=l.sent(),console.log("HELLLLOOOO"),console.log(t.device),Wt(t),i.connected?(e.commit("setDeviceConnect",!0),s=(n=e).commit,a=["setDeviceDetail"],[4,t.deviceDetail]):[3,9];case 7:return s.apply(n,a.concat([l.sent()])),e.commit("setConnectDeviceInProcess",!1),console.log(e.state.deviceDetail),console.log(e.state.deviceDetail.deviceName),r=e.state.deviceDetail.mac.replace(":","-"),[4,e.dispatch("initDataFirmware",r)];case 8:l.sent(),setTimeout((function(){var t=(e.state.deviceDetail.deviceName+" "+e.state.deviceDetail.deviceModel).toUpperCase();setTimeout((function(){e.dispatch("startNotifyTooltip",{message:t+" подключён",icon:"device"})}),600)}),600),setTimeout((function(){var t=e.state.deviceDetail.firmware,c=e.state.firmwareData.version;t!==c&&e.commit("setAlertUpdateStatus",!0)}),3200),l.label=9;case 9:return console.log("-------------------------------"),console.log(e.state.deviceDetail),t.device.addEventListener("gattserverdisconnected",(function(c){return Object(J["a"])(this,void 0,void 0,(function(){var c,i,n,s=this;return Object(J["b"])(this,(function(a){return console.log("Дисконнент"),e.commit("setDeviceConnect",!1),c=(e.state.deviceDetail.deviceName+" "+e.state.deviceDetail.deviceModel).toUpperCase(),e.dispatch("startNotifyTooltip",{message:c+" отключён",icon:"device"}),i={connected:!1},n=setInterval((function(){return Object(J["a"])(s,void 0,void 0,(function(){var c,s,a;return Object(J["b"])(this,(function(r){switch(r.label){case 0:return[4,t.connect()];case 1:return i=r.sent(),i["connected"]?(e.commit("setDeviceConnect",!0),s=(c=e).commit,a=["setDeviceDetail"],[4,t.deviceDetail]):[3,4];case 2:return s.apply(c,a.concat([r.sent()])),[4,e.dispatch("startGattNotify",t)];case 3:return r.sent(),e.dispatch("startNotifyTooltip",{message:"Подключение восстановлено",icon:"device"}),clearInterval(n),[3,5];case 4:e.commit("setDeviceConnect",!0),e.commit("setSlideupConnectDevice",!0),r.label=5;case 5:return[2]}}))}))}),3e3),[2]}))}))})),[4,e.dispatch("startGattNotify",t)];case 10:return l.sent(),[3,12];case 11:return o=l.sent(),e.commit("setConnectDeviceInProcess",!1),console.log(o),console.log("Ошибка подключения к устройству"),[3,12];case 12:return[2]}}))}))},startGattNotify:function(e,t){return Object(J["a"])(this,void 0,void 0,(function(){var c,i,n,s;return Object(J["b"])(this,(function(a){switch(a.label){case 0:console.log("Start dispatch events.."),console.log("PUFF EVENT"),console.log(t.charsHandle.service.puffCounter),a.label=1;case 1:return a.trys.push([1,3,,4]),t.charsHandle.service.puffCounter.addEventListener("characteristicvaluechanged",(function(t){var c=t.target.value.getUint8();e.commit("setPuffCount",c),console.log("> Event puff count is "+c),e.state.terminal.push("Событие затяжки: "+c+" (кол-во)")})),[4,t.charsHandle.service.puffCounter.startNotifications()];case 2:return a.sent(),[3,4];case 3:return c=a.sent(),console.log("error puff event"),console.log(c),[3,4];case 4:return a.trys.push([4,6,,7]),t.charsHandle.service.charge.addEventListener("characteristicvaluechanged",(function(t){var c=t.target.value.getUint8();e.commit("setChargeStatus",c),console.log("> Charge status "+c),e.state.terminal.push("Событие зарядки: "+c),c?e.dispatch("startNotifyTooltip",{message:"Зарядка подключена",icon:"charge"}):e.dispatch("startNotifyTooltip",{message:"Зарядка отключена",icon:"charge"})})),[4,t.charsHandle.service.charge.startNotifications()];case 5:return a.sent(),[3,7];case 6:return i=a.sent(),console.log(i),[3,7];case 7:return a.trys.push([7,9,,10]),t.charsHandle.battery.batteryLevel.addEventListener("characteristicvaluechanged",(function(t){var c=t.target.value.getUint8();e.commit("setBatteryLevel",c),console.log("> Заряд батареи "+c),e.state.terminal.push("Событие батареи: "+c+"%"),c<10&&e.dispatch("startNotifyTooltip",{message:"Требуется зарядка",icon:"charge"})})),[4,t.charsHandle.battery.batteryLevel.startNotifications()];case 8:return a.sent(),[3,10];case 9:return n=a.sent(),console.log(n),[3,10];case 10:return a.trys.push([10,12,,13]),t.charsHandle.service.cartridge.addEventListener("characteristicvaluechanged",(function(t){var c=t.target.value.getUint8();e.commit("setCartridge",c),console.log("> Картридж "+c),e.state.terminal.push("Событие картриджа: "+c),c>0?e.dispatch("startNotifyTooltip",{message:"Картридж подключён",icon:"tasty"}):e.dispatch("startNotifyTooltip",{message:"Картридж отключён",icon:"tasty"})})),[4,t.charsHandle.service.cartridge.startNotifications()];case 11:return a.sent(),[3,13];case 12:return s=a.sent(),console.log(s),[3,13];case 13:return[2]}}))}))}},modules:{}});Object(i["c"])(te).use(Kc).use(zc).mount("#app")},d66f:function(e,t,c){},dff7:function(e,t,c){},e24e:function(e,t,c){"use strict";c("dff7")},ee16:function(e,t,c){e.exports=c.p+"img/tasty.976f0e64.svg"},f92f:function(e,t,c){e.exports=c.p+"img/device-silver.fb96dede.png"},fd19:function(e,t,c){e.exports=c.p+"img/icon-main.18bee816.svg"}});
//# sourceMappingURL=app.7e2bfb55.js.map